<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assessing Balance • MatchIt</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Assessing Balance">
<meta property="og:description" content="MatchIt">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MatchIt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.4.0.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/MatchIt.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/matching-methods.html">Matching Methods</a>
    </li>
    <li>
      <a href="../articles/assessing-balance.html">Assessing Balance</a>
    </li>
    <li>
      <a href="../articles/estimating-effects.html">Estimating Effects After Matching</a>
    </li>
    <li>
      <a href="../articles/sampling-weights.html">Matching with Sampling Weights</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kosukeimai/MatchIt/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="assessing-balance_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Assessing Balance</h1>
                        <h4 data-toc-skip class="author">Noah Greifer</h4>
            
            <h4 data-toc-skip class="date">2022-08-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kosukeimai/MatchIt/blob/HEAD/vignettes/assessing-balance.Rmd" class="external-link"><code>vignettes/assessing-balance.Rmd</code></a></small>
      <div class="hidden name"><code>assessing-balance.Rmd</code></div>

    </div>

    
    
<style>
pre {
  overflow-x: auto;
}
pre code {
  word-wrap: normal;
  white-space: pre;
}
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Covariate balance is the degree to which the distribution of covariates is similar across levels of the treatment. It has three main roles in causal effect estimation using matching: 1) as a target to optimize with matching, 2) as a method of assessing the quality of the resulting matches, and 3) as evidence to an audience that the estimated effect is close to the true effect. When covariate balance is achieved, the resulting effect estimate is less sensitive to model misspecification and ideally close to true treatment effect. The benefit of randomization is that covariate balance is achieved automatically (in expectation), which is why unadjusted effects estimated from randomized trial data (in the absence of drop-out) can be validly interpreted as causal effects. When using matching to recover causal effect estimates form observational data, balance is not guaranteed and must be assessed.</p>
<p>This document provides instructions for assessing and reporting covariate balance as part of a matching analysis. The tools available in <code>MatchIt</code> for balance assessment should be used during the process of selecting a good matching scheme and ensuring that the chosen scheme is adequate. These tools implement the recommendations of <span class="citation">Ho et al. (<a href="#ref-ho2007" role="doc-biblioref">2007</a>)</span> and others for assessing balance.</p>
<p>In addition to the tools available in <code>matchIt</code>, the <code>cobalt</code> package has a suite of functions designed to assess and display balance and is directly compatible with <code>MatchIt</code> objects. <code>cobalt</code> has extensive documentation, but we describe some of its functionality here as a complement to the tools in <code>MatchIt</code>.</p>
<p>The structure of this document is as follows: first, we describe some of the recommendations for balance checking and their rationale; next, we describe the tools for assessing balance present in <code>MatchIt</code> and display their use in evaluating several matching schemes; finally; we briefly describe some of the functionality in <code>cobalt</code> to extend that in <code>MatchIt</code>.</p>
</div>
<div class="section level2">
<h2 id="recommendations-for-balance-assessment">Recommendations for Balance Assessment<a class="anchor" aria-label="anchor" href="#recommendations-for-balance-assessment"></a>
</h2>
<p>Assessing balance involves assessing whether the distributions of covariates are similar between the treated and control groups. Balance is typically assessed by examining univariate balance summary statistics for each covariate, though more complicated methods exist for assessing joint distributional balance as well. Visual depictions of distributional balance can be a helpful complement to numerical summaries, especially for hard to balance and prognostically important covariates.</p>
<p>Many recommendations for balance assessment have been described in the methodological literature. Unfortunately, there is no single best way to assess balance or to weigh balance summary statistics because the degree and form of balance that will yield the least bias in an effect estimate depends on unknown qualities of the outcome data-generating model. Nonetheless, there are a number of valuable recommendations that can be implemented to ensure matching is successful at eliminating or reducing bias. We review some of these here.</p>
<p>Common recommendations for assessing balance include the following:</p>
<ul>
<li><p><strong>Standardized mean differences</strong>. The standardized mean difference (SMD) is the difference in the means of each covariate between treatment groups standardized by a standardization factor so that it is on the same scale for all covariates. The standardization factor is typically the standard deviation of the covariate in the treated group when targeting the ATT or the pooled standard deviation across both groups when targeting the ATE. The standardization factor should be the same before and after matching to ensure changes in the mean difference are not confounded by changes in the standard deviation of the covariate. SMDs close to zero indicate good balance. Several recommended thresholds have been published in the literature; we recommend .1 and .05 for prognostically important covariates. Higher values may be acceptable when using covariate adjustment in the matched sample. In addition to computing SMDs on the covariates themselves, it is important to compute them on squares, cubes, and higher exponents as well as interactions between covariates. Several empirical studies have examined the appropriateness for using SMDs in balance assessment, including <span class="citation">Belitser et al. (<a href="#ref-belitser2011" role="doc-biblioref">2011</a>)</span>, <span class="citation">Ali et al. (<a href="#ref-ali2014" role="doc-biblioref">2014</a>)</span>, and <span class="citation">Stuart, Lee, and Leacy (<a href="#ref-stuart2013" role="doc-biblioref">2013</a>)</span>; in general, there is often a high correlation between the mean or maximum absolute SMD and the degree of bias in the treatment effect.</p></li>
<li><p><strong>Variance Ratios</strong>. The variance ratio is the ratio of the variance of a covariate in one group to that in the other. Variance ratios close to 1 indicate good balance because they imply the variances of the samples are similar <span class="citation">(Austin <a href="#ref-austin2009" role="doc-biblioref">2009</a>)</span>.</p></li>
<li><p><strong>Empirical CDF Statistics</strong>. Statistics related to the difference in the empirical cumulative density functions (eCDFs) of each covariate between groups allow assessment of imbalance across the entire covariate distribution of that covariate rather than just its mean or variance. The maximum eCDF difference, also known as the Kolmogorov-Smirnov statistic, is sometimes recommended as a useful supplement to SMDs for assessing balance <span class="citation">(Austin and Stuart <a href="#ref-austin2015" role="doc-biblioref">2015</a>)</span> and is often used as a criterion to use in propensity score methods that attempt to optimize balance <span class="citation">(e.g., McCaffrey, Ridgeway, and Morral <a href="#ref-mccaffrey2004" role="doc-biblioref">2004</a>; Diamond and Sekhon <a href="#ref-diamond2013" role="doc-biblioref">2013</a>)</span>. Although the mean eCDF difference has not been as well studied, it provides a summary of imbalance that may be missed by relying solely on the maximum difference.</p></li>
<li><p><strong>Visual Diagnostics</strong>. Visual diagnostics such as eCDF plots, empirical quantile-quantile (eQQ) plots, and kernel density plots can be used to see exactly how the covariate distributions differ from each other, i.e., where in the distribution the greatest imbalances are <span class="citation">(Ho et al. <a href="#ref-ho2007" role="doc-biblioref">2007</a>; Austin <a href="#ref-austin2009" role="doc-biblioref">2009</a>)</span>. This can help to figure out how to tailor a matching method to target imbalance in a specific region of the covariate distribution.</p></li>
<li><p><strong>Prognostic scores</strong>. The prognostic score is an estimate of the potential outcome under control for each unit <span class="citation">(Hansen <a href="#ref-hansen2008" role="doc-biblioref">2008</a>)</span>. Balance on the prognostic score has been shown to be highly correlated with bias in the effect estimate, making it a useful tool in balance assessment <span class="citation">(Stuart, Lee, and Leacy <a href="#ref-stuart2013" role="doc-biblioref">2013</a>)</span>. Estimating the prognostic score requires having access to the outcome data, and using it may be seen as violating the principle of separating the design and analysis stages of a matching analysis <span class="citation">(Rubin <a href="#ref-rubin2001" role="doc-biblioref">2001</a>)</span>. However, because only the outcome values from the control group are required to use the prognostic score, some separation is maintained.</p></li>
</ul>
<p>Several multivariate statistics exist that summarize balance across the entire joint covariate distribution. These can be functions of the above measures, like the mean or maximum absolute SMD or the generalized weighted distance <span class="citation">(GWD; Franklin et al. <a href="#ref-franklin2014" role="doc-biblioref">2014</a>)</span>, which is the sum of SMDs for the covariates and their squares and interactions, or separate statistics that measure quantities that abstract away from the distribution of individual covariates, like the L1 distance <span class="citation">(Iacus, King, and Porro <a href="#ref-iacus2011" role="doc-biblioref">2011</a>)</span>, cross-match test <span class="citation">(Heller, Rosenbaum, and Small <a href="#ref-heller2010" role="doc-biblioref">2010</a>)</span>, or energy distance <span class="citation">(Huling and Mak <a href="#ref-huling2020" role="doc-biblioref">2020</a>)</span>.</p>
<p>Balance on the propensity score has often been considered a useful measure of balance, but we do not necessarily recommend it except as a supplement to balance on the covariates. Propensity score balance will generally be good with any matching method regardless of the covariate balancing potential of the propensity score, so a balanced propensity score does not imply balanced covariates <span class="citation">(Austin <a href="#ref-austin2009" role="doc-biblioref">2009</a>)</span>. Similarly, it may happen that covariates may be well balanced even if the propensity score is not balanced, such as when covariates are prioritized above the propensity score in the matching specification (e.g., with genetic matching). Given these observations, the propensity score should not be relied upon for assessing covariate balance. Simulation studies by <span class="citation">Stuart, Lee, and Leacy (<a href="#ref-stuart2013" role="doc-biblioref">2013</a>)</span> provide evidence for this recommendation against relying on propensity score balance.</p>
<p>There has been some debate about the use of hypothesis tests, such as t-tests or Kolmogorov-Smirnov tests, for assessing covariate balance. The idea is that balance tests test the null hypothesis that the matched sample has equivalent balance to a randomized experiment. There are several problems with balance tests, described by <span class="citation">Ho et al. (<a href="#ref-ho2007" role="doc-biblioref">2007</a>)</span> and <span class="citation">Imai, King, and Stuart (<a href="#ref-imai2008" role="doc-biblioref">2008</a>)</span>: 1) balance is a property of the sample, not a of a population from which the sample was drawn; 2) the power of balance tests depends on the sample size, which changes during matching even if balance does not change; and 3) the use of hypothesis tests implies a uniform decision criterion for rejecting the null hypothesis (e.g., p-value less than .05, potentially with corrections for multiple comparisons), when balance should be improved without limit. <code>MatchIt</code> does not report any balance tests or p-values, instead relying on the descriptive statistics described above.</p>
</div>
<div class="section level2">
<h2 id="recommendations-for-balance-reporting">Recommendations for Balance Reporting<a class="anchor" aria-label="anchor" href="#recommendations-for-balance-reporting"></a>
</h2>
<p>A variety of methods should be used when assessing balance to try to find an optimal matched set that will ideally yield a low-error estimate of the desired effect. However, reporting every balance statistic or plot in a research report or publication can be burdensome and unnecessary. That said, it is critical to report balance to demonstrate to readers that the resulting estimate is approximately unbiased and relies little on extrapolation or correct outcome model specification. We recommend the following in reporting balance in a matching analysis:</p>
<ul>
<li><p>Report SMDs before and after matching for each covariate, any prognostically important interactions between covariates, and the prognostic score; this can be reported in a table or in a Love plot.</p></li>
<li><p>Report summaries of balance for other statistics, e.g., the largest mean and maximum eCDF difference among the covariates and the largest SMD among squares, cubes, and interactions of the covariates.</p></li>
</ul>
<p><code>MatchIt</code> provides tools for calculating each of these statistics so they can be reported with ease in a manuscript or report.</p>
</div>
<div class="section level2">
<h2 id="assessing-balance-with-matchit">Assessing Balance with <code>MatchIt</code><a class="anchor" aria-label="anchor" href="#assessing-balance-with-matchit"></a>
</h2>
<p><code>MatchIt</code> contains several tools to assess balance numerically and graphically. The primary balance assessment function is <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code>, which is called when using <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> on a <code>MatchIt</code> object and produces several tables of balance statistics before and after matching. <code><a href="../reference/plot.summary.matchit.html">plot.summary.matchit()</a></code> generates a Love plot using R’s base graphics system containing the standardized mean differences resulting from a call to <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code> and provides a nice way to display balance visually for inclusion in an article or report. <code><a href="../reference/plot.matchit.html">plot.matchit()</a></code> generates several plots that display different elements of covariate balance, including propensity score overlap and distribution plots of the covariates. These functions together form a suite that can be used to assess and report balance in a variety of ways.</p>
<p>To demonstrate <code>MatchIt</code>’s balance assessment capabilities, we will use the Lalonde data included in <code>MatchIt</code> and used in <code><a href="../articles/MatchIt.html">vignette("MatchIt")</a></code>. We will perform 1:1 nearest neighbor matching with replacement on the propensity score, though the functionality is identical across all matching methods except propensity score subclassification, which we illustrate at the end.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://kosukeimai.github.io/MatchIt/" class="external-link">"MatchIt"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span>, package <span class="op">=</span> <span class="st">"MatchIt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#1:1 NN matching w/ replacement on a logistic regression PS</span></span>
<span><span class="va">m.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> </span>
<span>                   <span class="va">nodegree</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>, data <span class="op">=</span> <span class="va">lalonde</span>,</span>
<span>                 replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">m.out</span></span></code></pre></div>
<pre><code><span><span class="co">## A matchit object</span></span>
<span><span class="co">##  - method: 1:1 nearest neighbor matching with replacement</span></span>
<span><span class="co">##  - distance: Propensity score</span></span>
<span><span class="co">##              - estimated with logistic regression</span></span>
<span><span class="co">##  - number of obs.: 614 (original), 265 (matched)</span></span>
<span><span class="co">##  - target estimand: ATT</span></span>
<span><span class="co">##  - covariates: age, educ, race, married, nodegree, re74, re75</span></span></code></pre>
<div class="section level3">
<h3 id="summary-matchit">
<code>summary.matchit()</code><a class="anchor" aria-label="anchor" href="#summary-matchit"></a>
</h3>
<p>When <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> is called on a <code>matchit</code> object, several tables of information are displayed. These include balance statistics for each covariate before matching, balance statistics for each covariate after matching, the percent reduction in imbalance after matching, and the sample sizes before and after matching. <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code> has four additional arguments that control how balance is computed:</p>
<ul>
<li>
<code>interactions</code> controls whether balance statistics for all squares and pairwise interactions of covariates are to be displayed in addition to the covariates. The default is <code>FALSE</code>, and setting to <code>TRUE</code> can make the output massive when many covariates are present, but it is important to ensure no important interactions remain imbalanced.</li>
<li>
<code>addlvariables</code> allows for balance to be assessed on variables other than those inside the <code>matchit</code> object. For example, if the distance between units only relied on a subset of covariates but balance needed to be achieved on all covariates, <code>addlvariables</code> could be used to supply these additional covariates. In addition to adding other variables, <code>addlvariables</code> can be used to request balance on specific functions of the covariates already in the <code>matchit</code> object, such as polynomial terms or interactions. The input to <code>addlvariables</code> can be a one-sided formula with the covariates and any desired transformations thereof on the right hand side, just like a model formula (e.g., <code>addlvariables = ~ X1 + X2 + I(X1^2)</code> would request balance on <code>X1</code>, <code>X2</code>, and the square of <code>X1</code>). Additional variables supplied to <code>addlvariables</code> but not present in the <code>matchit</code> object can be supplied as a data frame using the <code>data</code> argument.</li>
<li>
<code>standardize</code> controls whether standardized or unstandardized statistics are to displayed. Standardized statistics include the standardized mean difference and eCDF statistics; unstandardized statistics include the raw difference in means and eQQ plot statistics. (Regardless, the variance ratio will always be displayed.). The default is <code>TRUE</code> for standardized statistics, which are more common to report because they are all on the same scale regardless of the scale of the covariates<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</li>
<li>
<code>pair.dist</code> controls whether within-pair distances should be computed and displayed. These reflect the average distance between units within the same pair, standardized or unstandardized according to the argument to <code>standardize</code>. The default is <code>TRUE</code>. With full matching, exact matching, coarsened exact matching, and propensity score subclassification, computing pair distances can take a long time, and so it may be beneficial to set to <code>FALSE</code> in these cases.</li>
</ul>
<p>In addition, the arguments <code>un</code> and <code>improvement</code> control whether balance prior to matching should be displayed and whether the percent balance improvement after matching should be displayed. These can be set to <code>FALSE</code> to reduce the output.</p>
<p>Below, we call <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code> with <code>addlvariables</code> to display balance on covariates and a few functions of them in the matched sample. In particular, we request balance on the square of <code>age</code>, the variables representing whether <code>re74</code> and <code>re75</code> were equal to 0, and the interaction between <code>educ</code> and <code>race</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out</span>, addlvariables <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">re74</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">re75</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="va">educ</span><span class="op">:</span><span class="va">race</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## matchit(formula = treat ~ age + educ + race + married + nodegree + </span></span>
<span><span class="co">##     re74 + re75, data = lalonde, replace = TRUE)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary of Balance for All Data:</span></span>
<span><span class="co">##                  Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span></span>
<span><span class="co">## distance                 0.577         0.182           1.794      0.921     0.377    0.644</span></span>
<span><span class="co">## age                     25.816        28.030          -0.309      0.440     0.081    0.158</span></span>
<span><span class="co">## educ                    10.346        10.235           0.055      0.496     0.035    0.111</span></span>
<span><span class="co">## raceblack                0.843         0.203           1.762          .     0.640    0.640</span></span>
<span><span class="co">## racehispan               0.059         0.142          -0.350          .     0.083    0.083</span></span>
<span><span class="co">## racewhite                0.097         0.655          -1.882          .     0.558    0.558</span></span>
<span><span class="co">## married                  0.189         0.513          -0.826          .     0.324    0.324</span></span>
<span><span class="co">## nodegree                 0.708         0.597           0.245          .     0.111    0.111</span></span>
<span><span class="co">## re74                  2095.574      5619.237          -0.721      0.518     0.225    0.447</span></span>
<span><span class="co">## re75                  1532.055      2466.484          -0.290      0.956     0.134    0.288</span></span>
<span><span class="co">## I(age^2)               717.395       901.779          -0.428      0.363     0.081    0.158</span></span>
<span><span class="co">## I(re74 == 0)TRUE         0.708         0.261           0.983          .     0.447    0.447</span></span>
<span><span class="co">## I(re75 == 0)TRUE         0.600         0.312           0.587          .     0.288    0.288</span></span>
<span><span class="co">## educ:raceblack           8.697         2.047           1.580      0.980     0.354    0.645</span></span>
<span><span class="co">## educ:racehispan          0.578         1.263          -0.294      0.487     0.046    0.078</span></span>
<span><span class="co">## educ:racewhite           1.070         6.925          -1.767      0.365     0.279    0.555</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary of Balance for Matched Data:</span></span>
<span><span class="co">##                  Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max Std. Pair Dist.</span></span>
<span><span class="co">## distance                 0.577         0.576           0.004      0.991     0.003    0.049           0.013</span></span>
<span><span class="co">## age                     25.816        24.103           0.239      0.556     0.077    0.341           1.262</span></span>
<span><span class="co">## educ                    10.346        10.378          -0.016      0.576     0.022    0.059           1.086</span></span>
<span><span class="co">## raceblack                0.843         0.838           0.015          .     0.005    0.005           0.045</span></span>
<span><span class="co">## racehispan               0.059         0.065          -0.023          .     0.005    0.005           0.297</span></span>
<span><span class="co">## racewhite                0.097         0.097           0.000          .     0.000    0.000           0.054</span></span>
<span><span class="co">## married                  0.189         0.130           0.152          .     0.059    0.059           0.511</span></span>
<span><span class="co">## nodegree                 0.708         0.703           0.012          .     0.005    0.005           0.868</span></span>
<span><span class="co">## re74                  2095.574      2336.463          -0.049      1.035     0.041    0.216           0.609</span></span>
<span><span class="co">## re75                  1532.055      1503.929           0.009      2.126     0.068    0.238           0.650</span></span>
<span><span class="co">## I(age^2)               717.395       670.946           0.108      0.509     0.077    0.341           1.196</span></span>
<span><span class="co">## I(re74 == 0)TRUE         0.708         0.492           0.476          .     0.216    0.216           0.975</span></span>
<span><span class="co">## I(re75 == 0)TRUE         0.600         0.362           0.485          .     0.238    0.238           1.037</span></span>
<span><span class="co">## educ:raceblack           8.697         8.589           0.026      0.868     0.024    0.054           0.468</span></span>
<span><span class="co">## educ:racehispan          0.578         0.638          -0.026      0.826     0.007    0.022           0.336</span></span>
<span><span class="co">## educ:racewhite           1.070         1.151          -0.024      0.845     0.005    0.022           0.220</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Sample Sizes:</span></span>
<span><span class="co">##               Control Treated</span></span>
<span><span class="co">## All            429.       185</span></span>
<span><span class="co">## Matched (ESS)   43.49     185</span></span>
<span><span class="co">## Matched         80.       185</span></span>
<span><span class="co">## Unmatched      349.         0</span></span>
<span><span class="co">## Discarded        0.         0</span></span></code></pre>
<p>Let’s examine the output in detail. The first table (<code>Summary of Balance for All Data</code>) provides balance in the sample prior to matching. The included statistics are the mean of the covariates in the treated group (<code>Means Treated</code>), the mean of the covariate in the control group (<code>Means Control</code>), the SMDs (<code>Std. Mean Diff.</code>), the variance ratio (<code>Var. Ratio</code>), the average distance between the eCDFs of the covariate across the groups (<code>eCDF Mean</code>), and the largest distance between the eCDFs (<code>eCDF Max</code>). Setting <code>un = FALSE</code> would have suppressed the creation of this table.</p>
<p>The second table (<code>Summary of Balance for Matched Data</code>) contains all the same statistics in the matched sample. Because we implicitly request pair distance, an additional column for standardized pair distances (<code>Std. Pair Dist.</code>) is displayed.</p>
<p>The third table (<code>Percent Balance Improvement</code>) contains the percent balance improvement for each covariate. This is computed as <span class="math inline">\(100\frac{|\theta_M| - |\theta_U|}{|\theta_U|}\)</span>, where <span class="math inline">\(\theta_M\)</span> is a given balance statistic in the matched sample and <span class="math inline">\(\theta_U\)</span> is a the same balance statistic in the unmatched sample. Values between 0 and 100 indicate that balance improved after matching as measured by the statistic; values less than 0 indicate that balance got worse after matching. When balance is good on a covariate prior to matching, it can sometimes look like balance got a lot worse after matching even though the balance statistic is quite low, so these values should not be taken too seriously and should be used primarily as heuristics. Setting <code>un = FALSE</code> or <code>improvement = FALSE</code> would have suppressed the creation of this table.</p>
<p>The final table (<code>Sample Sizes</code>) contains the sizes of the samples before (<code>All</code>) and after (<code>Matched</code>) matching, as well as the number of units left unmatched (<code>Unmatched</code>) and the number of units dropped due to a common support restriction (<code>Discarded</code>).</p>
<p>The SMDs are computed as the mean difference divided by a standardization factor computed in the <strong>unmatched</strong> sample. An absolute SMD close to 0 indicates good balance; although a number of recommendations for acceptable values have appeared in the literature, we recommend absolute values less than .1 and less than .05 for potentially prognostically important variables.</p>
<p>The variance ratios are computed as the ratio of the variance of the treated group to that of the control group for each covariate. Variance ratios are not computed for binary covariates because they are a function of the prevalence in each group, which is captured in the mean difference and eCDF statistics. A variance ratio close to 1 indicates good balance; a commonly used recommendation is for variance ratios to be between .5 and 2.</p>
<p>The eCDF statistics correspond to the difference in the overall distributions of the covariates between the treatment groups. The values of both statistics range from 0 to 1, with values closer to zero indicating better balance. There are no specific recommendations for the values these statistics should take, though notably high values may indicate imbalance on higher moments of the covariates. The eQQ statistics produced when <code>standardize = FALSE</code> are interpreted similarly but are on the scale of the covariate.</p>
<p>All these statistics should be considered together. Imbalance as measured by any of them may indicate a potential failure of the matching scheme to achieve distributional balance.</p>
</div>
<div class="section level3">
<h3 id="plot-summary-matchit">
<code>plot.summary.matchit()</code><a class="anchor" aria-label="anchor" href="#plot-summary-matchit"></a>
</h3>
<p>A Love plot is a clean way to visually summarize balance. Using <code>plot</code> on the output of a call to <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> on a <code>matchit</code> object produces a Love plot of the standardized mean differences. <code><a href="../reference/plot.summary.matchit.html">plot.summary.matchit()</a></code> has several additional arguments that can be used to customize the plot.</p>
<ul>
<li>
<code>abs</code> controls whether standardized mean difference should be displayed in absolute value or not. Default is <code>TRUE</code>.</li>
<li>
<code>var.order</code> controls how the variables are ordered on the y-axis. The options are <code>"data"</code> (the default), which orders the variables as they appear the in the <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code> output; <code>"unmatched"</code>, which orders the variables based on their standardized mean differences before matching; <code>"matched"</code>, which orders the variables based on their standardized mean differences after matching; and <code>"alphabetical"</code>, which orders the variables alphabetically. Using <code>"unmatched"</code> tends to result in attractive plots and ensures the legend doesn’t overlap with points in its default position.</li>
<li>
<code>threshold</code> controls where vertical lines indicating chosen thresholds should appear on the x-axis. Should be a numeric vector. The default is <code>c(.1, .05)</code>, which display vertical lines at .1 and .05 standardized mean difference units.</li>
<li>
<code>position</code> controls the position of the legend. The default is <code>"bottomright"</code>, which puts the legend in the bottom right corner of the plot, and any keyword value available to supplied to <code>x</code> in <code><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend()</a></code> is allowed.</li>
</ul>
<p>Below we create a Love plot of the covariates.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m.sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out</span>, addlvariables <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">re74</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">re75</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="va">educ</span><span class="op">:</span><span class="va">race</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m.sum</span>, var.order <span class="op">=</span> <span class="st">"unmatched"</span><span class="op">)</span></span></code></pre></div>
<p><img src="assessing-balance_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>From this plot it is clear to see that balance was quite poor prior to matching, but full matching improved balance on all covariates, and most within a threshold of .1. To make the variable names cleaner, the original variables should be renamed prior to matching. <code>cobalt</code> provides many additional options to generate and customize Love plots using the <code><a href="https://ngreifer.github.io/cobalt/reference/love.plot.html" class="external-link">love.plot()</a></code> function and should be used if a plot beyond what is available with <code><a href="../reference/plot.summary.matchit.html">plot.summary.matchit()</a></code> is desired.</p>
</div>
<div class="section level3">
<h3 id="plot-matchit">
<code>plot.matchit()</code><a class="anchor" aria-label="anchor" href="#plot-matchit"></a>
</h3>
<p>In addition to numeric summaries of balance, <code>MatchIt</code> offers graphical summaries as well using <code><a href="../reference/plot.matchit.html">plot.matchit()</a></code> (i.e., using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on a <code>matchit</code> object). We can create eQQ plots, eCDF plots, or density plots of the covariates and histograms or jitter plots of the propensity score. The covariate plots can provide a summary of the balance of the full marginal distribution of a covariate beyond just the mean and variance.</p>
<p><code><a href="../reference/plot.matchit.html">plot.matchit()</a></code> has a few arguments to customize the output:</p>
<ul>
<li>
<code>type</code> corresponds to the type of plot desired. Options include <code>"qq"</code> for eQQ plots (the default), <code>"ecdf"</code> for eCDF plots, <code>"density"</code> for density plots, <code>"jitter"</code> for jitter plots, and <code>"histogram"</code> for histograms.</li>
<li>
<code>interactive</code> controls whether the plot is interactive or not. For eQQ, eCDF, and density plots, this allows us to control when the next page of covariates is to be displayed since only three can appear at a time. For jitter plots, this can allow us to select individual units with extreme values for further inspection. The default is <code>TRUE</code>.</li>
<li>
<code>which.xs</code> is used to specify for which covariates to display balance in eQQ, eCDF, and density plots. The default is to display balance on all, but we can request balance just on a specific subset. If three or fewer are requested, <code>interactive</code> is ignored.</li>
</ul>
<p>Below, we demonstrate the eQQ plot:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#eQQ plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m.out</span>, type <span class="op">=</span> <span class="st">"qq"</span>, which.xs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"nodegree"</span>, <span class="st">"re74"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="assessing-balance_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>The y-axis displays the each value of the covariate for the treated units, and the x-axis displays the the value of the covariate at the corresponding quantile in the control group. When values fall on the 45 degree line, the groups are balanced. Above, we can see that <code>age</code> remains somewhat imbalanced, but <code>nodegree</code> and <code>re74</code> have much better balance after matching than before. The difference between the x and y values of each point are used to compute the eQQ difference statistics that are displayed in <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code> with <code>standardize = FALSE</code>.</p>
<p>Below, we demonstrate the eCDF plot:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#eCDF plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m.out</span>, type <span class="op">=</span> <span class="st">"ecdf"</span>, which.xs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"educ"</span>, <span class="st">"married"</span>, <span class="st">"re75"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="assessing-balance_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>The x-axis displays the covariate values and the y-axis displays the proportion of the sample at or less than that covariate value. Perfectly overlapping lines indicate good balance. The black line corresponds to the treated group and the gray line to the control group. Although <code>educ</code> and <code>re75</code> were fairly well balanced before matching, their balance has improved nonetheless. <code>married</code> appears far better balanced after matching than before. The vertical difference between the eCDFs lines of each treatment group is used to compute the eCDF difference statistics that are displayed in <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code> with <code>standardize = TRUE</code>.</p>
<p>Below, we demonstrate the density plot:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#density plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m.out</span>, type <span class="op">=</span> <span class="st">"density"</span>, which.xs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"educ"</span>, <span class="st">"married"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="assessing-balance_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>The x-axis displays the covariate values and the y-axis displays the density of the sample at that covariate value. For binary variables, the y-axis displays the proportion of the sample at that covariate value. Perfectly overlapping lines indicate good balance. The black line corresponds to the treated group and the gray line to the control group. Density plots display similar information to eCDF plots but may be more intuitive for some users because of their link to histograms.</p>
</div>
</div>
<div class="section level2">
<h2 id="assessing-balance-after-subclassification">Assessing Balance After Subclassification<a class="anchor" aria-label="anchor" href="#assessing-balance-after-subclassification"></a>
</h2>
<p>With subclassification, balance can be checked both within each subclass and overall. With <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code>, we can request to view balance only in aggregate or in each subclass. The latter can help us decide if we can interpret effects estimated within each subclass as unbiased. The <code><a href="../reference/plot.summary.matchit.html">plot.summary.matchit()</a></code> and <code><a href="../reference/plot.matchit.html">plot.matchit()</a></code> outputs can be requested either in aggregate or for each subclass. We demonstrate this below. First we will perform propensity score subclassification using 4 subclasses (typically more is beneficial).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Subclassification on a logistic regression PS</span></span>
<span><span class="va">s.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> </span>
<span>                   <span class="va">nodegree</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>, data <span class="op">=</span> <span class="va">lalonde</span>,</span>
<span>                 method <span class="op">=</span> <span class="st">"subclass"</span>, subclass <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">s.out</span></span></code></pre></div>
<pre><code><span><span class="co">## A matchit object</span></span>
<span><span class="co">##  - method: Subclassification (4 subclasses)</span></span>
<span><span class="co">##  - distance: Propensity score</span></span>
<span><span class="co">##              - estimated with logistic regression</span></span>
<span><span class="co">##  - number of obs.: 614 (original), 614 (matched)</span></span>
<span><span class="co">##  - target estimand: ATT</span></span>
<span><span class="co">##  - covariates: age, educ, race, married, nodegree, re74, re75</span></span></code></pre>
<p>When using <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, the default is to display balance only in aggregate using the subclassification weights. This balance output looks similar to that for other matching methods.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s.out</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## matchit(formula = treat ~ age + educ + race + married + nodegree + </span></span>
<span><span class="co">##     re74 + re75, data = lalonde, method = "subclass", subclass = 4)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary of Balance for All Data:</span></span>
<span><span class="co">##            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span></span>
<span><span class="co">## distance           0.577         0.182           1.794      0.921     0.377    0.644</span></span>
<span><span class="co">## age               25.816        28.030          -0.309      0.440     0.081    0.158</span></span>
<span><span class="co">## educ              10.346        10.235           0.055      0.496     0.035    0.111</span></span>
<span><span class="co">## raceblack          0.843         0.203           1.762          .     0.640    0.640</span></span>
<span><span class="co">## racehispan         0.059         0.142          -0.350          .     0.083    0.083</span></span>
<span><span class="co">## racewhite          0.097         0.655          -1.882          .     0.558    0.558</span></span>
<span><span class="co">## married            0.189         0.513          -0.826          .     0.324    0.324</span></span>
<span><span class="co">## nodegree           0.708         0.597           0.245          .     0.111    0.111</span></span>
<span><span class="co">## re74            2095.574      5619.237          -0.721      0.518     0.225    0.447</span></span>
<span><span class="co">## re75            1532.055      2466.484          -0.290      0.956     0.134    0.288</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary of Balance Across Subclasses</span></span>
<span><span class="co">##            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span></span>
<span><span class="co">## distance           0.577         0.539           0.173      0.678     0.062    0.126</span></span>
<span><span class="co">## age               25.816        24.975           0.118      0.465     0.085    0.297</span></span>
<span><span class="co">## educ              10.346        10.433          -0.043      0.582     0.023    0.061</span></span>
<span><span class="co">## raceblack          0.843         0.767           0.210          .     0.076    0.076</span></span>
<span><span class="co">## racehispan         0.059         0.042           0.076          .     0.018    0.018</span></span>
<span><span class="co">## racewhite          0.097         0.191          -0.318          .     0.094    0.094</span></span>
<span><span class="co">## married            0.189         0.196          -0.017          .     0.007    0.007</span></span>
<span><span class="co">## nodegree           0.708         0.657           0.113          .     0.051    0.051</span></span>
<span><span class="co">## re74            2095.574      2557.709          -0.095      0.968     0.048    0.264</span></span>
<span><span class="co">## re75            1532.055      1490.040           0.013      1.505     0.035    0.146</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Sample Sizes:</span></span>
<span><span class="co">##               Control Treated</span></span>
<span><span class="co">## All             429.      185</span></span>
<span><span class="co">## Matched (ESS)   102.3     185</span></span>
<span><span class="co">## Matched         429.      185</span></span>
<span><span class="co">## Unmatched         0.        0</span></span>
<span><span class="co">## Discarded         0.        0</span></span></code></pre>
<p>An additional option in <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, <code>subclass</code>, allows us to request balance for individual subclasses. <code>subclass</code> can be set to <code>TRUE</code> to display balance for all subclasses or the indices of individual subclasses for which balance is to be displayed. Below we call <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> and request balance to be displayed on all subclasses (setting <code>un = FALSE</code> to suppress balance in the original sample):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s.out</span>, subclass <span class="op">=</span> <span class="cn">TRUE</span>, un <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## matchit(formula = treat ~ age + educ + race + married + nodegree + </span></span>
<span><span class="co">##     re74 + re75, data = lalonde, method = "subclass", subclass = 4)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary of Balance by Subclass:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## - Subclass 1</span></span>
<span><span class="co">##            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span></span>
<span><span class="co">## distance           0.239         0.095           0.653      2.494     0.313    0.508</span></span>
<span><span class="co">## age               26.478        28.800          -0.324      0.394     0.090    0.160</span></span>
<span><span class="co">## educ              10.304        10.214           0.045      0.620     0.025    0.084</span></span>
<span><span class="co">## raceblack          0.370         0.063           0.843          .     0.307    0.307</span></span>
<span><span class="co">## racehispan         0.239         0.167           0.304          .     0.072    0.072</span></span>
<span><span class="co">## racewhite          0.391         0.770          -1.277          .     0.379    0.379</span></span>
<span><span class="co">## married            0.370         0.589          -0.560          .     0.219    0.219</span></span>
<span><span class="co">## nodegree           0.587         0.584           0.007          .     0.003    0.003</span></span>
<span><span class="co">## re74            5430.539      6363.913          -0.191      1.298     0.087    0.284</span></span>
<span><span class="co">## re75            2929.039      2699.399           0.071      1.587     0.047    0.144</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## - Subclass 2</span></span>
<span><span class="co">##            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span></span>
<span><span class="co">## distance           0.604         0.612          -0.035      0.905     0.083    0.195</span></span>
<span><span class="co">## age               25.556        24.409           0.160      0.461     0.114    0.370</span></span>
<span><span class="co">## educ               9.933         9.773           0.080      0.448     0.084    0.188</span></span>
<span><span class="co">## raceblack          1.000         1.000           0.000          .     0.000    0.000</span></span>
<span><span class="co">## racehispan         0.000         0.000           0.000          .     0.000    0.000</span></span>
<span><span class="co">## racewhite          0.000         0.000           0.000          .     0.000    0.000</span></span>
<span><span class="co">## married            0.378         0.091           0.732          .     0.287    0.287</span></span>
<span><span class="co">## nodegree           0.667         0.500           0.367          .     0.167    0.167</span></span>
<span><span class="co">## re74            1777.422      2516.589          -0.151      0.433     0.076    0.280</span></span>
<span><span class="co">## re75             972.344      1131.077          -0.049      0.666     0.034    0.086</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## - Subclass 3</span></span>
<span><span class="co">##            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span></span>
<span><span class="co">## distance           0.693         0.691           0.012      1.281     0.055    0.189</span></span>
<span><span class="co">## age               24.021        22.964           0.148      0.509     0.128    0.281</span></span>
<span><span class="co">## educ              10.170        10.286          -0.057      1.040     0.038    0.099</span></span>
<span><span class="co">## raceblack          1.000         1.000           0.000          .     0.000    0.000</span></span>
<span><span class="co">## racehispan         0.000         0.000           0.000          .     0.000    0.000</span></span>
<span><span class="co">## racewhite          0.000         0.000           0.000          .     0.000    0.000</span></span>
<span><span class="co">## married            0.021         0.107          -0.219          .     0.086    0.086</span></span>
<span><span class="co">## nodegree           0.681         0.750          -0.152          .     0.069    0.069</span></span>
<span><span class="co">## re74             939.969       888.947           0.010      2.038     0.059    0.216</span></span>
<span><span class="co">## re75            1217.455      1285.387          -0.021      1.535     0.038    0.188</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## - Subclass 4</span></span>
<span><span class="co">##            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span></span>
<span><span class="co">## distance           0.767         0.753           0.063      2.961     0.165    0.445</span></span>
<span><span class="co">## age               27.213        23.786           0.479      0.521     0.150    0.459</span></span>
<span><span class="co">## educ              10.957        11.429          -0.234      0.701     0.059    0.126</span></span>
<span><span class="co">## raceblack          1.000         1.000           0.000          .     0.000    0.000</span></span>
<span><span class="co">## racehispan         0.000         0.000           0.000          .     0.000    0.000</span></span>
<span><span class="co">## racewhite          0.000         0.000           0.000          .     0.000    0.000</span></span>
<span><span class="co">## married            0.000         0.000           0.000          .     0.000    0.000</span></span>
<span><span class="co">## nodegree           0.894         0.786           0.237          .     0.108    0.108</span></span>
<span><span class="co">## re74             291.783       540.618          -0.051      0.917     0.083    0.280</span></span>
<span><span class="co">## re75            1015.289       854.751           0.050      3.523     0.112    0.266</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Sample Sizes by Subclass:</span></span>
<span><span class="co">##           1  2  3  4 All</span></span>
<span><span class="co">## Control 365 22 28 14 429</span></span>
<span><span class="co">## Treated  46 45 47 47 185</span></span>
<span><span class="co">## Total   411 67 75 61 614</span></span></code></pre>
<p>We can plot the standardized mean differences in a Love plot that also displays balance for the subclasses using <code><a href="../reference/plot.summary.matchit.html">plot.summary.matchit()</a></code> on a <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code> object with <code>subclass = TRUE</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s.out</span>, subclass <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s</span>, var.order <span class="op">=</span> <span class="st">"unmatched"</span>, abs <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="assessing-balance_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>Note that for some variables, while the groups are balanced in aggregate (black dots), the individual subclasses (gray numbers) may not be balanced, in which case unadjusted effect estimates within these subclasses should not be interpreted as unbiased.</p>
<p>When we plot distributional balance using <code><a href="../reference/plot.matchit.html">plot.matchit()</a></code>, again we can choose whether balance should be displayed in aggregate or within subclasses again using the <code>subclass</code> option, which functions the same as it does with <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code>. Below we demonstrate checking balance within a subclass.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s.out</span>, type <span class="op">=</span> <span class="st">"density"</span>, which.xs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"educ"</span>, <span class="st">"married"</span>, <span class="st">"re75"</span><span class="op">)</span>,</span>
<span>     subclass <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="assessing-balance_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>If we had set <code>subclass = FALSE</code>, plots would have been displayed in aggregate using the subclassification weights. If <code>subclass</code> is unspecified, a prompt will ask us for which subclass we want to see balance.</p>
</div>
<div class="section level2">
<h2 id="assessing-balance-with-cobalt">Assessing Balance with <code>cobalt</code><a class="anchor" aria-label="anchor" href="#assessing-balance-with-cobalt"></a>
</h2>
<p>The <code>cobalt</code> package was designed specifically for checking balance before and after matching (and weighting). It offers three main functions, <code><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab()</a></code>, <code><a href="https://ngreifer.github.io/cobalt/reference/love.plot.html" class="external-link">love.plot()</a></code>, and <code><a href="https://ngreifer.github.io/cobalt/reference/bal.plot.html" class="external-link">bal.plot()</a></code>, which perform similar actions to <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code>, <code><a href="../reference/plot.summary.matchit.html">plot.summary.matchit()</a></code>, and <code><a href="../reference/plot.matchit.html">plot.matchit()</a></code>, respectively. These functions directly interface with <code>matchit</code> objects, making <code>cobalt</code> straightforward to use in conjunction with <code>MatchIt</code>. <code>cobalt</code> can be used as a complement to <code>MatchIt</code>, especially for more advanced uses that are not accommodated by <code>MatchIt</code>, such as comparing balance across different matching schemes and even different packages, assessing balance in clustered or multiply imputed data, and assessing balance with multi-category, continuous, and time-varying treatments. The main <code>cobalt</code> vignette contains many examples of its use with <code>MatchIt</code> objects, so we only provide a short demonstration of its capabilities here.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ngreifer.github.io/cobalt/" class="external-link">"cobalt"</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="bal-tab">
<code>bal.tab()</code><a class="anchor" aria-label="anchor" href="#bal-tab"></a>
</h3>
<p><code><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab()</a></code> produces tables of balance statistics similar to <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code>. The columns displayed can be customized to limit how much information is displayed and isolate desired information. We call <code><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab()</a></code> with a few of its options specified below:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab</a></span><span class="op">(</span><span class="va">m.out</span>, un <span class="op">=</span> <span class="cn">TRUE</span>, stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"v"</span>, <span class="st">"ks"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="text-decoration: underline;">Call</span></span></span>
<span><span class="co">##  matchit(formula = treat ~ age + educ + race + married + nodegree + </span></span>
<span><span class="co">##     re74 + re75, data = lalonde, replace = TRUE)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="text-decoration: underline;">Balance Measures</span></span></span>
<span><span class="co">##                 Type Diff.Un V.Ratio.Un KS.Un Diff.Adj V.Ratio.Adj KS.Adj</span></span>
<span><span class="co">## distance    Distance   1.794      0.921 0.644    0.004       0.991  0.049</span></span>
<span><span class="co">## age          Contin.  -0.309      0.440 0.158    0.239       0.556  0.341</span></span>
<span><span class="co">## educ         Contin.   0.055      0.496 0.111   -0.016       0.576  0.059</span></span>
<span><span class="co">## race_black    Binary   0.640          . 0.640    0.005           .  0.005</span></span>
<span><span class="co">## race_hispan   Binary  -0.083          . 0.083   -0.005           .  0.005</span></span>
<span><span class="co">## race_white    Binary  -0.558          . 0.558    0.000           .  0.000</span></span>
<span><span class="co">## married       Binary  -0.324          . 0.324    0.059           .  0.059</span></span>
<span><span class="co">## nodegree      Binary   0.111          . 0.111    0.005           .  0.005</span></span>
<span><span class="co">## re74         Contin.  -0.721      0.518 0.447   -0.049       1.035  0.216</span></span>
<span><span class="co">## re75         Contin.  -0.290      0.956 0.288    0.009       2.126  0.238</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="text-decoration: underline;">Sample sizes</span></span></span>
<span><span class="co">##                      Control Treated</span></span>
<span><span class="co">## All                   429.       185</span></span>
<span><span class="co">## Matched (ESS)          43.49     185</span></span>
<span><span class="co">## Matched (Unweighted)   80.       185</span></span>
<span><span class="co">## Unmatched             349.         0</span></span></code></pre>
<p>The output is very similar to that of <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code>, except that the balance statistics computed before matching (with the suffix <code>.Un</code>) and those computed after matching (with the suffix <code>.Adj</code>) are in the same table. By default, only SMDs after matching (<code>Diff.Adj</code>) are displayed; by setting <code>un = TRUE</code>, we requested that the balance statistics before matching also be displayed, and by setting <code>stats = c("m", "v", "ks")</code> we requested mean differences, variance ratios, and Kolmogorov-Smirnov statistics. Other balance statistics and summary statistics can be requested as well. One important detail to note is that the default for binary covariates is to print the raw difference in proportion rather than the standardized mean difference, so there will be an apparent discrepancy for these variables between <code><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab()</a></code> and <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code> output, though this behavior can be changed by setting <code>binary = "std"</code> in the call to <code><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab()</a></code>. Functionality for producing balance statistics for additional variables and for powers and interactions of the covariates is available using the <code>addl</code>, <code>poly</code>, and <code>int</code> options.</p>
<p><code><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab()</a></code> and other <code>cobalt</code> functions can produce balance not just on a single <code>matchit</code> object but on several at the same time, which facilitates comparing balance across several matching specifications. For example, if we wanted to compare the full matching results to the results of nearest neighbor matching without replacement, we could supply both to <code><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab()</a></code>, which we demonstrate below:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Nearest neighbor (NN) matching on the PS</span></span>
<span><span class="va">m.out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> </span>
<span>                   <span class="va">nodegree</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>, data <span class="op">=</span> <span class="va">lalonde</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Balance on covariates after full and NN matching</span></span>
<span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> </span>
<span>          <span class="va">nodegree</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>, data <span class="op">=</span> <span class="va">lalonde</span>, </span>
<span>        un <span class="op">=</span> <span class="cn">TRUE</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>full <span class="op">=</span> <span class="va">m.out</span>, nn <span class="op">=</span> <span class="va">m.out2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="text-decoration: underline;">Balance Measures</span></span></span>
<span><span class="co">##                Type Diff.Un Diff.full Diff.nn</span></span>
<span><span class="co">## age         Contin.  -0.309     0.239   0.072</span></span>
<span><span class="co">## educ        Contin.   0.055    -0.016  -0.129</span></span>
<span><span class="co">## race_black   Binary   0.640     0.005   0.373</span></span>
<span><span class="co">## race_hispan  Binary  -0.083    -0.005  -0.157</span></span>
<span><span class="co">## race_white   Binary  -0.558     0.000  -0.216</span></span>
<span><span class="co">## married      Binary  -0.324     0.059  -0.022</span></span>
<span><span class="co">## nodegree     Binary   0.111     0.005   0.070</span></span>
<span><span class="co">## re74        Contin.  -0.721    -0.049  -0.050</span></span>
<span><span class="co">## re75        Contin.  -0.290     0.009  -0.026</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="text-decoration: underline;">Effective sample sizes</span></span></span>
<span><span class="co">##      Control Treated</span></span>
<span><span class="co">## All   429.       185</span></span>
<span><span class="co">## full   43.49     185</span></span>
<span><span class="co">## nn    185.       185</span></span></code></pre>
<p>This time, we supplied <code><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab()</a></code> with the covariates and dataset and supplied the <code>matchit</code> output objects in the <code>weights</code> argument (which extracts the matching weights from the objects). Here we can see that full matching yields better balance than nearest neighbor matching overall, though balance is slightly worse for <code>age</code> and <code>maried</code> and the effective sample size is lower.</p>
</div>
<div class="section level3">
<h3 id="love-plot">
<code>love.plot</code><a class="anchor" aria-label="anchor" href="#love-plot"></a>
</h3>
<p><code><a href="https://ngreifer.github.io/cobalt/reference/love.plot.html" class="external-link">love.plot()</a></code> creates a Love plot of chosen balance statistics. It offers many options for customization, including the shape and colors of the points, how the variable names are displayed, and for which statistics balance is to be displayed. Below is an example of its basic use:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/love.plot.html" class="external-link">love.plot</a></span><span class="op">(</span><span class="va">m.out</span>, binary <span class="op">=</span> <span class="st">"std"</span><span class="op">)</span></span></code></pre></div>
<p><img src="assessing-balance_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<p>The syntax is straightforward and similar to that of <code><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab()</a></code>. Below we demonstrate a more advanced use that customizes the appearance of the plot and displays balance not only on mean differences but also on Kolmogorov-Smirnov statistics and for both full matching and nearest neighbor matching simultaneously.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/love.plot.html" class="external-link">love.plot</a></span><span class="op">(</span><span class="va">m.out</span>, stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"ks"</span><span class="op">)</span>, poly <span class="op">=</span> <span class="fl">2</span>, abs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nn <span class="op">=</span> <span class="va">m.out2</span><span class="op">)</span>,</span>
<span>          drop.distance <span class="op">=</span> <span class="cn">TRUE</span>, thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>          var.order <span class="op">=</span> <span class="st">"unadjusted"</span>, binary <span class="op">=</span> <span class="st">"std"</span>,</span>
<span>          shapes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"triangle"</span>, <span class="st">"square"</span>, <span class="st">"circle"</span><span class="op">)</span>, </span>
<span>          colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"darkgreen"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>          sample.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Full Matching"</span>, <span class="st">"NN Matching"</span>, <span class="st">"Original"</span><span class="op">)</span>,</span>
<span>          position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="assessing-balance_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<p>The <code><a href="https://ngreifer.github.io/cobalt/reference/love.plot.html" class="external-link">love.plot()</a></code> documentation explains what each of these arguments do and the several other ones available. <code>cobalt</code> contains a vignette for other advanced customization of <code><a href="https://ngreifer.github.io/cobalt/reference/love.plot.html" class="external-link">love.plot()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="bal-plot">
<code>bal.plot()</code><a class="anchor" aria-label="anchor" href="#bal-plot"></a>
</h3>
<p><code><a href="https://ngreifer.github.io/cobalt/reference/bal.plot.html" class="external-link">bal.plot()</a></code> displays distributional balance for a single covariate, similar to <code><a href="../reference/plot.matchit.html">plot.matchit()</a></code>. Its default is to display kernel density plots for continuous variables and bar graphs for categorical variables. It can also display eCDF plots and histograms. Below we demonstrate some of its uses:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Density plot for continuous variables</span></span>
<span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/bal.plot.html" class="external-link">bal.plot</a></span><span class="op">(</span><span class="va">m.out</span>, var.name <span class="op">=</span> <span class="st">"educ"</span>, which <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></code></pre></div>
<p><img src="assessing-balance_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Bar graph for categorical variables</span></span>
<span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/bal.plot.html" class="external-link">bal.plot</a></span><span class="op">(</span><span class="va">m.out</span>, var.name <span class="op">=</span> <span class="st">"race"</span>, which <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></code></pre></div>
<p><img src="assessing-balance_files/figure-html/unnamed-chunk-17-2.png" width="672"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Mirrored histogram</span></span>
<span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/bal.plot.html" class="external-link">bal.plot</a></span><span class="op">(</span><span class="va">m.out</span>, var.name <span class="op">=</span> <span class="st">"distance"</span>, which <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>         type <span class="op">=</span> <span class="st">"histogram"</span>, mirror <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="assessing-balance_files/figure-html/unnamed-chunk-17-3.png" width="672"></p>
<p>These plots help illuminate the specific ways in which the covariate distributions differ between treatment groups, which can aid in interpreting the balance statistics provided by <code><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html" class="external-link">bal.tab()</a></code> and <code><a href="../reference/summary.matchit.html">summary.matchit()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The goal of matching is to achieve covariate balance, similarity between the covariate distributions of the treated and control groups. Balance should be assessed during the matching phase to find a matching specification that works. Balance must also be reported in the write-up of a matching analysis to demonstrate to readers that matching was successful. <code>MatchIt</code> and <code>cobalt</code> each offer a suite of functions to implement best practices in balance assessment and reporting.</p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-ali2014">
<p>Ali, M. Sanni, Rolf H. H. Groenwold, Wiebe R. Pestman, Svetlana V. Belitser, Kit C. B. Roes, Arno W. Hoes, Anthonius de Boer, and Olaf H. Klungel. 2014. “Propensity Score Balance Measures in Pharmacoepidemiology: A Simulation Study.” <em>Pharmacoepidemiology and Drug Safety</em> 23 (8): 802–11. <a href="https://doi.org/10.1002/pds.3574" class="external-link">https://doi.org/10.1002/pds.3574</a>.</p>
</div>
<div id="ref-austin2009">
<p>Austin, Peter C. 2009. “Balance Diagnostics for Comparing the Distribution of Baseline Covariates Between Treatment Groups in Propensity-Score Matched Samples.” <em>Statistics in Medicine</em> 28 (25): 3083–3107. <a href="https://doi.org/10.1002/sim.3697" class="external-link">https://doi.org/10.1002/sim.3697</a>.</p>
</div>
<div id="ref-austin2015">
<p>Austin, Peter C., and Elizabeth A. Stuart. 2015. “Moving Towards Best Practice When Using Inverse Probability of Treatment Weighting (Iptw) Using the Propensity Score to Estimate Causal Treatment Effects in Observational Studies.” <em>Statistics in Medicine</em> 34 (28): 3661–79. <a href="https://doi.org/10.1002/sim.6607" class="external-link">https://doi.org/10.1002/sim.6607</a>.</p>
</div>
<div id="ref-belitser2011">
<p>Belitser, Svetlana V., Edwin P. Martens, Wiebe R. Pestman, Rolf H.H. Groenwold, Anthonius de Boer, and Olaf H. Klungel. 2011. “Measuring Balance and Model Selection in Propensity Score Methods.” <em>Pharmacoepidemiology and Drug Safety</em> 20 (11): 1115–29. <a href="https://doi.org/10.1002/pds.2188" class="external-link">https://doi.org/10.1002/pds.2188</a>.</p>
</div>
<div id="ref-diamond2013">
<p>Diamond, Alexis, and Jasjeet S. Sekhon. 2013. “Genetic Matching for Estimating Causal Effects: A General Multivariate Matching Method for Achieving Balance in Observational Studies.” <em>Review of Economics and Statistics</em> 95 (3): 932945. <a href="https://doi.org/10.1162/REST_a_00318" class="external-link">https://doi.org/10.1162/REST_a_00318</a>.</p>
</div>
<div id="ref-franklin2014">
<p>Franklin, Jessica M., Jeremy A. Rassen, Diana Ackermann, Dorothee B. Bartels, and Sebastian Schneeweiss. 2014. “Metrics for Covariate Balance in Cohort Studies of Causal Effects.” <em>Statistics in Medicine</em> 33 (10): 1685–99. <a href="https://doi.org/10.1002/sim.6058" class="external-link">https://doi.org/10.1002/sim.6058</a>.</p>
</div>
<div id="ref-hansen2008">
<p>Hansen, Ben B. 2008. “The Prognostic Analogue of the Propensity Score.” <em>Biometrika</em> 95 (2): 481–88. <a href="https://doi.org/10.1093/biomet/asn004" class="external-link">https://doi.org/10.1093/biomet/asn004</a>.</p>
</div>
<div id="ref-heller2010">
<p>Heller, Ruth, Paul R. Rosenbaum, and Dylan S. Small. 2010. “Using the Cross-Match Test to Appraise Covariate Balance in Matched Pairs.” <em>The American Statistician</em> 64 (4): 299–309. <a href="https://doi.org/10.1198/tast.2010.09210" class="external-link">https://doi.org/10.1198/tast.2010.09210</a>.</p>
</div>
<div id="ref-ho2007">
<p>Ho, Daniel E., Kosuke Imai, Gary King, and Elizabeth A. Stuart. 2007. “Matching as Nonparametric Preprocessing for Reducing Model Dependence in Parametric Causal Inference.” <em>Political Analysis</em> 15 (3): 199–236. <a href="https://doi.org/10.1093/pan/mpl013" class="external-link">https://doi.org/10.1093/pan/mpl013</a>.</p>
</div>
<div id="ref-huling2020">
<p>Huling, Jared D., and Simon Mak. 2020. “Energy Balancing of Covariate Distributions.” <em>arXiv:2004.13962 [Stat]</em>, April. <a href="https://arxiv.org/abs/2004.13962" class="external-link">https://arxiv.org/abs/2004.13962</a>.</p>
</div>
<div id="ref-iacus2011">
<p>Iacus, Stefano M., Gary King, and Giuseppe Porro. 2011. “Multivariate Matching Methods That Are Monotonic Imbalance Bounding.” <em>Journal of the American Statistical Association</em> 106 (493): 345–61. <a href="https://doi.org/10.1198/jasa.2011.tm09599" class="external-link">https://doi.org/10.1198/jasa.2011.tm09599</a>.</p>
</div>
<div id="ref-imai2008">
<p>Imai, Kosuke, Gary King, and Elizabeth A. Stuart. 2008. “Misunderstandings Between Experimentalists and Observationalists About Causal Inference.” <em>Journal of the Royal Statistical Society. Series A (Statistics in Society)</em> 171 (2): 481–502. <a href="https://doi.org/10.1111/j.1467-985X.2007.00527.x" class="external-link">https://doi.org/10.1111/j.1467-985X.2007.00527.x</a>.</p>
</div>
<div id="ref-mccaffrey2004">
<p>McCaffrey, Daniel F., Greg Ridgeway, and Andrew R. Morral. 2004. “Propensity Score Estimation with Boosted Regression for Evaluating Causal Effects in Observational Studies.” <em>Psychological Methods</em> 9 (4): 403–25. <a href="https://doi.org/10.1037/1082-989X.9.4.403" class="external-link">https://doi.org/10.1037/1082-989X.9.4.403</a>.</p>
</div>
<div id="ref-rubin2001">
<p>Rubin, Donald B. 2001. “Using Propensity Scores to Help Design Observational Studies: Application to the Tobacco Litigation.” <em>Health Services and Outcomes Research Methodology</em> 2 (3-4): 169–88. <a href="https://doi.org/10.1023/A:1020363010465" class="external-link">https://doi.org/10.1023/A:1020363010465</a>.</p>
</div>
<div id="ref-stuart2013">
<p>Stuart, Elizabeth A., Brian K. Lee, and Finbarr P. Leacy. 2013. “Prognostic Score-Based Balance Measures Can Be a Useful Diagnostic for Propensity Score Methods in Comparative Effectiveness Research.” <em>Journal of Clinical Epidemiology</em> 66 (8): S84. <a href="https://doi.org/10.1016/j.jclinepi.2013.01.013" class="external-link">https://doi.org/10.1016/j.jclinepi.2013.01.013</a>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Note that versions of <code>MatchIt</code> before 4.0.0 had <code>standardize</code> set to <code>FALSE</code> by default.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Daniel Ho, Kosuke Imai, Gary King, Elizabeth Stuart, Noah Greifer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
