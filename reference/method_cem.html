<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Coarsened Exact Matching — method_cem • MatchIt</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Coarsened Exact Matching — method_cem"><meta name="description" content="In matchit(), setting method = &quot;cem&quot; performs coarsened exact
matching. With coarsened exact matching, covariates are coarsened into bins,
and a complete cross of the coarsened covariates is used to form subclasses
defined by each combination of the coarsened covariate levels. Any subclass
that doesn't contain both treated and control units is discarded, leaving
only subclasses containing treatment and control units that are exactly
equal on the coarsened covariates. The coarsening process can be controlled
by an algorithm or by manually specifying cutpoints and groupings. The
benefits of coarsened exact matching are that the tradeoff between exact
matching and approximate balancing can be managed to prevent discarding too
many units, which can otherwise occur with exact matching.
This page details the allowable arguments with method = &quot;cem&quot;. See
matchit() for an explanation of what each argument means in a general
context and how it can be specified.
Below is how matchit() is used for coarsened exact matching:
matchit(formula,
        data = NULL,
        method = &quot;cem&quot;,
        estimand = &quot;ATT&quot;,
        s.weights = NULL,
        verbose = FALSE,
        ...)
"><meta property="og:description" content="In matchit(), setting method = &quot;cem&quot; performs coarsened exact
matching. With coarsened exact matching, covariates are coarsened into bins,
and a complete cross of the coarsened covariates is used to form subclasses
defined by each combination of the coarsened covariate levels. Any subclass
that doesn't contain both treated and control units is discarded, leaving
only subclasses containing treatment and control units that are exactly
equal on the coarsened covariates. The coarsening process can be controlled
by an algorithm or by manually specifying cutpoints and groupings. The
benefits of coarsened exact matching are that the tradeoff between exact
matching and approximate balancing can be managed to prevent discarding too
many units, which can otherwise occur with exact matching.
This page details the allowable arguments with method = &quot;cem&quot;. See
matchit() for an explanation of what each argument means in a general
context and how it can be specified.
Below is how matchit() is used for coarsened exact matching:
matchit(formula,
        data = NULL,
        method = &quot;cem&quot;,
        estimand = &quot;ATT&quot;,
        s.weights = NULL,
        verbose = FALSE,
        ...)
"><meta property="og:image" content="https://kosukeimai.github.io/MatchIt/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MatchIt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MatchIt.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/matching-methods.html">Matching Methods</a></li>
    <li><a class="dropdown-item" href="../articles/assessing-balance.html">Assessing Balance</a></li>
    <li><a class="dropdown-item" href="../articles/estimating-effects.html">Estimating Effects After Matching</a></li>
    <li><a class="dropdown-item" href="../articles/sampling-weights.html">Matching with Sampling Weights</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kosukeimai/MatchIt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Coarsened Exact Matching</h1>
      <small class="dont-index">Source: <a href="https://github.com/kosukeimai/MatchIt/blob/master/R/matchit2cem.R" class="external-link"><code>R/matchit2cem.R</code></a></small>
      <div class="d-none name"><code>method_cem.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In <code><a href="matchit.html">matchit()</a></code>, setting <code>method = "cem"</code> performs coarsened exact
matching. With coarsened exact matching, covariates are coarsened into bins,
and a complete cross of the coarsened covariates is used to form subclasses
defined by each combination of the coarsened covariate levels. Any subclass
that doesn't contain both treated and control units is discarded, leaving
only subclasses containing treatment and control units that are exactly
equal on the coarsened covariates. The coarsening process can be controlled
by an algorithm or by manually specifying cutpoints and groupings. The
benefits of coarsened exact matching are that the tradeoff between exact
matching and approximate balancing can be managed to prevent discarding too
many units, which can otherwise occur with exact matching.</p>
<p>This page details the allowable arguments with <code>method = "cem"</code>. See
<code><a href="matchit.html">matchit()</a></code> for an explanation of what each argument means in a general
context and how it can be specified.</p>
<p>Below is how <code><a href="matchit.html">matchit()</a></code> is used for coarsened exact matching:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="../reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>        data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"cem"</span>,</span>
<span>        estimand <span class="op">=</span> <span class="st">"ATT"</span>,</span>
<span>        s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        <span class="va">...</span><span class="op">)</span> </span></code></pre></div>

    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a two-sided <a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a> object containing the treatment and
covariates to be used in creating the subclasses defined by a full cross of
the coarsened covariate levels.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame containing the variables named in <code>formula</code>.
If not found in <code>data</code>, the variables will be sought in the
environment.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>set here to <code>"cem"</code>.</p></dd>


<dt id="arg-estimand">estimand<a class="anchor" aria-label="anchor" href="#arg-estimand"></a></dt>
<dd><p>a string containing the desired estimand. Allowable options
include <code>"ATT"</code>, <code>"ATC"</code>, and <code>"ATE"</code>. The estimand controls
how the weights are computed; see the Computing Weights section at
<code><a href="matchit.html">matchit()</a></code> for details. When <code>k2k = TRUE</code> (see below), <code>estimand</code>
also controls how the matching is done.</p></dd>


<dt id="arg-s-weights">s.weights<a class="anchor" aria-label="anchor" href="#arg-s-weights"></a></dt>
<dd><p>the variable containing sampling weights to be incorporated
into balance statistics or the scaling factors when <code>k2k = TRUE</code> and
certain methods are used.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical</code>; whether information about the matching
process should be printed to the console.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to control the matching process.</p><dl><dt><code>grouping</code></dt>
<dd><p>a named list with an (optional) entry
for each categorical variable to be matched on. Each element should itself
be a list, and each entry of the sublist should be a vector containing
levels of the variable that should be combined to form a single level. Any
categorical variables not included in <code>grouping</code> will remain as they
are in the data, which means exact matching, with no coarsening, will take
place on these variables. See Details.</p></dd>

<dt><code>cutpoints</code></dt>
<dd><p>a named list with an (optional) entry for each numeric variable to be matched on.
Each element describes a way of coarsening the corresponding variable. They
can be a vector of cutpoints that demarcate bins, a single number giving the
number of bins, or a string corresponding to a method of computing the
number of bins. Allowable strings include <code>"sturges"</code>, <code>"scott"</code>,
and <code>"fd"</code>, which use the functions
<code><a href="https://rdrr.io/r/grDevices/nclass.html" class="external-link">grDevices::nclass.Sturges()</a></code>, <code><a href="https://rdrr.io/r/grDevices/nclass.html" class="external-link">grDevices::nclass.scott()</a></code>,
and <code><a href="https://rdrr.io/r/grDevices/nclass.html" class="external-link">grDevices::nclass.FD()</a></code>, respectively. The default is
<code>"sturges"</code> for variables that are not listed or if no argument is
supplied. Can also be a single value to be applied to all numeric variables.
See Details.</p></dd>

<dt><code>k2k</code></dt>
<dd><p><code>logical</code>; whether 1:1 matching should
occur within the matched strata. If <code>TRUE</code> nearest neighbor matching
without replacement will take place within each stratum, and any unmatched
units will be dropped (e.g., if there are more treated than control units in
the stratum, the treated units without a match will be dropped). The
<code>k2k.method</code> argument controls how the distance between units is
calculated.</p></dd>

<dt><code>k2k.method</code></dt>
<dd><p><code>character</code>; how the distance
between units should be calculated if <code>k2k = TRUE</code>. Allowable arguments
include <code>NULL</code> (for random matching), any argument to
<code><a href="distance.html">distance()</a></code> for computing a distance matrix from covariates
(e.g., <code>"mahalanobis"</code>), or any allowable argument to <code>method</code> in
<code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist()</a></code>. Matching will take place on the original
(non-coarsened) variables. The default is <code>"mahalanobis"</code>.</p></dd>

<dt><code>mpower</code></dt>
<dd><p>if <code>k2k.method = "minkowski"</code>, the power used in
creating the distance. This is passed to the <code>p</code> argument of <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist()</a></code>.</p></dd>

<dt><code>m.order</code></dt>
<dd><p><code>character</code>; the order that the matching takes place when <code>k2k = TRUE</code>. Allowable options
include <code>"closest"</code>, where matching takes place in
ascending order of the smallest distance between units; <code>"farthest"</code>, where matching takes place in
descending order of the smallest distance between units; <code>"random"</code>, where matching takes place
in a random order; and <code>"data"</code> where matching takes place based on the
order of units in the data. When <code>m.order = "random"</code>, results may differ
across different runs of the same code unless a seed is set and specified
with <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>. The default of <code>NULL</code> corresponds to <code>"data"</code>. See <code><a href="method_nearest.html">method_nearest</a></code> for more information.</p></dd>


</dl><p>The arguments <code>distance</code> (and related arguments), <code>exact</code>, <code>mahvars</code>, <code>discard</code> (and related arguments), <code>replace</code>, <code>caliper</code> (and related arguments), and <code>ratio</code> are ignored with a warning.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If the coarsening is such that there are no exact matches with the coarsened
variables, the <code>grouping</code> and <code>cutpoints</code> arguments can be used to
modify the matching specification. Reducing the number of cutpoints or
grouping some variable values together can make it easier to find matches.
See Examples below. Removing variables can also help (but they will likely
not be balanced unless highly correlated with the included variables). To
take advantage of coarsened exact matching without failing to find any
matches, the covariates can be manually coarsened outside of
<code><a href="matchit.html">matchit()</a></code> and then supplied to the <code>exact</code> argument in a call to
<code><a href="matchit.html">matchit()</a></code> with another matching method.</p>
<p>Setting <code>k2k = TRUE</code> is equivalent to first doing coarsened exact
matching with <code>k2k = FALSE</code> and then supplying stratum membership as an
exact matching variable (i.e., in <code>exact</code>) to another call to
<code><a href="matchit.html">matchit()</a></code> with <code>method = "nearest"</code>.
It is also equivalent to performing nearest neighbor matching supplying
coarsened versions of the variables to <code>exact</code>, except that
<code>method = "cem"</code> automatically coarsens the continuous variables. The
<code>estimand</code> argument supplied with <code>method = "cem"</code> functions the
same way it would in these alternate matching calls, i.e., by determining
the "focal" group that controls the order of the matching.</p><div class="section">
<h3 id="grouping-and-cutpoints">Grouping and Cutpoints<a class="anchor" aria-label="anchor" href="#grouping-and-cutpoints"></a></h3>


<p>The <code>grouping</code> and <code>cutpoints</code>
arguments allow one to fine-tune the coarsening of the covariates.
<code>grouping</code> is used for combining categories of categorical covariates
and <code>cutpoints</code> is used for binning numeric covariates. The values
supplied to these arguments should be iteratively changed until a matching
solution that balances covariate balance and remaining sample size is
obtained. The arguments are described below.</p><div class="section">
<h4 id="grouping"><code>grouping</code><a class="anchor" aria-label="anchor" href="#grouping"></a></h4>


<p>The argument to <code>grouping</code> must be a list, where each component has the
name of a categorical variable, the levels of which are to be combined. Each
component must itself be a list; this list contains one or more vectors of
levels, where each vector corresponds to the levels that should be combined
into a single category. For example, if a variable <code>amount</code> had levels
<code>"none"</code>, <code>"some"</code>, and <code>"a lot"</code>, one could enter
<code>grouping = list(amount = list(c("none"), c("some", "a lot")))</code>, which
would group <code>"some"</code> and <code>"a lot"</code> into a single category and
leave <code>"none"</code> in its own category. Any levels left out of the list for
each variable will be left alone (so <code>c("none")</code> could have been
omitted from the previous code). Note that if a categorical variable does
not appear in <code>grouping</code>, it will not be coarsened, so exact matching
will take place on it. <code>grouping</code> should not be used for numeric
variables with more than a few values; use <code>cutpoints</code>, described below, instead.</p>
</div>

<div class="section">
<h4 id="cutpoints"><code>cutpoints</code><a class="anchor" aria-label="anchor" href="#cutpoints"></a></h4>


<p>The argument to <code>cutpoints</code> must also be a list, where each component
has the name of a numeric variables that is to be binned. (As a shortcut, it
can also be a single value that will be applied to all numeric variables).
Each component can take one of three forms: a vector of cutpoints that
separate the bins, a single number giving the number of bins, or a string
corresponding to an algorithm used to compute the number of bins. Any values
at a boundary will be placed into the higher bin; e.g., if the cutpoints
were <code>c(0, 5, 10)</code>, values of 5 would be placed into the same bin as
values of 6, 7, 8, or 9, and values of 10 would be placed into a different
bin. Internally, values of <code>-Inf</code> and <code>Inf</code> are appended to the
beginning and end of the range. When given as a single number defining the
number of bins, the bin boundaries are the maximum and minimum values of the
variable with bin boundaries evenly spaced between them, i.e., not
quantiles. A value of 0 will not perform any binning (equivalent to exact
matching on the variable), and a value of 1 will remove the variable from
the exact matching variables but it will be still used for pair matching
when <code>k2k = TRUE</code>. The allowable strings include <code>"sturges"</code>,
<code>"scott"</code>, and <code>"fd"</code>, which use the corresponding binning method,
and <code>"q#"</code> where <code>#</code> is a number, which splits the variable into
<code>#</code> equally-sized bins (i.e., quantiles).</p>
<p>An example of a way to supply an argument to <code>cutpoints</code> would be the
following:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="va">cutpoints</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>X1 <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                 X2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.7</span>, <span class="fl">5.5</span>, <span class="fl">10.2</span><span class="op">)</span>,</span>
<span>                 X3 <span class="op">=</span> <span class="st">"scott"</span>,</span>
<span>                 X4 <span class="op">=</span> <span class="st">"q5"</span><span class="op">)</span> </span></code></pre></div>

<p>This would split <code>X1</code> into 4 bins, <code>X2</code>
into bins based on the provided boundaries, <code>X3</code> into a number of bins
determined by <code><a href="https://rdrr.io/r/grDevices/nclass.html" class="external-link">grDevices::nclass.scott()</a></code>, and <code>X4</code> into
quintiles. All other numeric variables would be split into a number of bins
determined by <code><a href="https://rdrr.io/r/grDevices/nclass.html" class="external-link">grDevices::nclass.Sturges()</a></code>, the default.</p>
</div>


</div>

    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This method does not rely on the <em>cem</em> package, instead using
code written for <em>MatchIt</em>, but its design is based on the original
<em>cem</em> functions. Versions of <em>MatchIt</em> prior to 4.1.0 did rely on
<em>cem</em>, so results may differ between versions. There are a few
differences between the ways <em>MatchIt</em> and <em>cem</em> (and older
versions of <em>MatchIt</em>) differ in executing coarsened exact matching,
described below.</p><ul><li><p>In <em>MatchIt</em>, when a single number is
supplied to <code>cutpoints</code>, it describes the number of bins; in
<em>cem</em>, it describes the number of cutpoints separating bins. The
<em>MatchIt</em> method is closer to how <code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist()</a></code> processes breaks points to
create bins.</p></li>
<li><p>In <em>MatchIt</em>, values on the cutpoint boundaries will
be placed into the higher bin; in <em>cem</em>, they are placed into the lower
bin. To avoid consequences of this choice, ensure the bin boundaries do not
coincide with observed values of the variables.</p></li>
<li><p>When <code>cutpoints</code> are used, <code>"ss"</code> (for Shimazaki-Shinomoto's rule) can be used in
<em>cem</em> but not in <em>MatchIt</em>.</p></li>
<li><p>When <code>k2k = TRUE</code>, <em>MatchIt</em> matches on the original variables (scaled), whereas
<em>cem</em> matches on the coarsened variables. Because the variables are
already exactly matched on the coarsened variables, matching in <em>cem</em>
is equivalent to random matching within strata.</p></li>
<li><p>When <code>k2k = TRUE</code>, in <em>MatchIt</em> matched units are identified by pair membership, and the
original stratum membership prior to 1:1 matching is discarded. In
<em>cem</em>, pairs are not identified beyond the stratum the members are part of.</p></li>
<li><p>When <code>k2k = TRUE</code>, <code>k2k.method = "mahalanobis"</code> can be
requested in <em>MatchIt</em> but not in <em>cem</em>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a></h2>



<p>All outputs described in <code><a href="matchit.html">matchit()</a></code> are returned with
<code>method = "cem"</code> except for <code>match.matrix</code>. When <code>k2k = TRUE</code>, a <code>match.matrix</code> component with the matched pairs is also
included. <code>include.obj</code> is ignored.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>In a manuscript, you don't need to cite another package when
using <code>method = "cem"</code> because the matching is performed completely
within <em>MatchIt</em>. For example, a sentence might read:</p>
<p><em>Coarsened exact matching was performed using the MatchIt package (Ho,
Imai, King, &amp; Stuart, 2011) in R.</em></p>
<p>It would be a good idea to cite the following article, which develops the
theory behind coarsened exact matching:</p>
<p>Iacus, S. M., King, G., &amp; Porro, G. (2012). Causal Inference without Balance
Checking: Coarsened Exact Matching. <em>Political Analysis</em>, 20(1), 1–24. <a href="https://doi.org/10.1093/pan/mpr013" class="external-link">doi:10.1093/pan/mpr013</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="matchit.html">matchit()</a></code> for a detailed explanation of the inputs and outputs of
a call to <code><a href="matchit.html">matchit()</a></code>.</p>
<p>The <em>cem</em> package, upon which this method is based and which provided
the workhorse in previous versions of <em>MatchIt</em>.</p>
<p><code><a href="method_exact.html">method_exact</a></code> for exact matching, which performs exact matching
on the covariates without coarsening.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Coarsened exact matching on age, race, married, and educ with educ</span></span></span>
<span class="r-in"><span><span class="co"># coarsened into 5 bins and race coarsened into 2 categories,</span></span></span>
<span class="r-in"><span><span class="co"># grouping "white" and "hispan" together</span></span></span>
<span class="r-in"><span><span class="va">m.out1</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> <span class="va">educ</span>, data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>                  method <span class="op">=</span> <span class="st">"cem"</span>, cutpoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>educ <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  grouping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>race <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"hispan"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m.out1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `matchit` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: Coarsened exact matching</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 393 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, race, married, educ</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + race + married + educ, data = lalonde, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "cem", cutpoints = list(educ = 5), grouping = list(race = list(c("white", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "hispan"), c("black"))))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for All Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.8162       28.0303         -0.3094     0.4400    0.0813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8432        0.2028          1.7615          .    0.6404</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0595        0.1422         -0.3498          .    0.0827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.0973        0.6550         -1.8819          .    0.5577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1892        0.5128         -0.8263          .    0.3236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.3459       10.2354          0.0550     0.4959    0.0347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.1577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.6404</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.5577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.3236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.1114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              24.1007       23.7091          0.0547     0.8882    0.0140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8188        0.8188          0.0000          .    0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0671        0.0360          0.1317          .    0.0312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.1141        0.1452         -0.1051          .    0.0312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1745        0.1745         -0.0000          .    0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.5369       10.8649         -0.1631     0.7974    0.0177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.0897          0.1555</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.0000          0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0312          0.4829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.0312          0.3853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.0000          0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.1865          0.3962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All            429.       185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched (ESS)   52.84     149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched        244.       149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched      185.        36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded        0.         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The same but requesting 1:1 Mahalanobis distance matching with</span></span></span>
<span class="r-in"><span><span class="co"># the k2k and k2k.method argument. Note the remaining number of units</span></span></span>
<span class="r-in"><span><span class="co"># is smaller than when retaining the full matched sample.</span></span></span>
<span class="r-in"><span><span class="va">m.out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> <span class="va">educ</span>, data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>                  method <span class="op">=</span> <span class="st">"cem"</span>, cutpoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>educ <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  grouping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>race <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"hispan"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                              <span class="st">"black"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  k2k <span class="op">=</span> <span class="cn">TRUE</span>, k2k.method <span class="op">=</span> <span class="st">"mahalanobis"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m.out2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `matchit` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: Coarsened exact matching</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 170 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, race, married, educ</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out2</span>, un <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + race + married + educ, data = lalonde, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "cem", cutpoints = list(educ = 5), grouping = list(race = list(c("white", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "hispan"), "black")), k2k = TRUE, k2k.method = "mahalanobis")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              23.6353       23.4118          0.0312     0.9022    0.0126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.6824        0.6824          0.0000          .    0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.1176        0.0706          0.1990          .    0.0471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.2000        0.2471         -0.1588          .    0.0471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.2118        0.2118          0.0000          .    0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.2588       10.5176         -0.1287     0.8036    0.0149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.0824          0.1003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.0000          0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0471          0.1990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.0471          0.1588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.0000          0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.1294          0.2106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All           429     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched        85      85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched     344     100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Ho, Kosuke Imai, Gary King, Elizabeth Stuart, Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

