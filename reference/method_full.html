<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimal Full Matching — method_full • MatchIt</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal Full Matching — method_full"><meta name="description" content='In matchit(), setting method = "full" performs optimal full
matching, which is a form of subclassification wherein all units, both
treatment and control (i.e., the "full" sample), are assigned to a subclass
and receive at least one match. The matching is optimal in the sense that
that sum of the absolute distances between the treated and control units in
each subclass is as small as possible. The method relies on and is a wrapper
for optmatch::fullmatch().
Advantages of optimal full matching include that the matching order is not
required to be specified, units do not need to be discarded, and it is less
likely that extreme within-subclass distances will be large, unlike with
standard subclassification. The primary output of full matching is a set of
matching weights that can be applied to the matched sample; in this way,
full matching can be seen as a robust alternative to propensity score
weighting, robust in the sense that the propensity score model does not need
to be correct to estimate the treatment effect without bias. Note: with large samples, the optimization may fail or run very slowly; one can try using method = "quick" instead, which also performs full matching but can be much faster.
This page details the allowable arguments with method = "full".
See matchit() for an explanation of what each argument means in a general
context and how it can be specified.
Below is how matchit() is used for optimal full matching:
matchit(formula,
        data = NULL,
        method = "full",
        distance = "glm",
        link = "logit",
        distance.options = list(),
        estimand = "ATT",
        exact = NULL,
        mahvars = NULL,
        anitexact = NULL,
        discard = "none",
        reestimate = FALSE,
        s.weights = NULL,
        caliper = NULL,
        std.caliper = TRUE,
        verbose = FALSE,
        ...)

'><meta property="og:description" content='In matchit(), setting method = "full" performs optimal full
matching, which is a form of subclassification wherein all units, both
treatment and control (i.e., the "full" sample), are assigned to a subclass
and receive at least one match. The matching is optimal in the sense that
that sum of the absolute distances between the treated and control units in
each subclass is as small as possible. The method relies on and is a wrapper
for optmatch::fullmatch().
Advantages of optimal full matching include that the matching order is not
required to be specified, units do not need to be discarded, and it is less
likely that extreme within-subclass distances will be large, unlike with
standard subclassification. The primary output of full matching is a set of
matching weights that can be applied to the matched sample; in this way,
full matching can be seen as a robust alternative to propensity score
weighting, robust in the sense that the propensity score model does not need
to be correct to estimate the treatment effect without bias. Note: with large samples, the optimization may fail or run very slowly; one can try using method = "quick" instead, which also performs full matching but can be much faster.
This page details the allowable arguments with method = "full".
See matchit() for an explanation of what each argument means in a general
context and how it can be specified.
Below is how matchit() is used for optimal full matching:
matchit(formula,
        data = NULL,
        method = "full",
        distance = "glm",
        link = "logit",
        distance.options = list(),
        estimand = "ATT",
        exact = NULL,
        mahvars = NULL,
        anitexact = NULL,
        discard = "none",
        reestimate = FALSE,
        s.weights = NULL,
        caliper = NULL,
        std.caliper = TRUE,
        verbose = FALSE,
        ...)

'><meta property="og:image" content="https://kosukeimai.github.io/MatchIt/logo.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" integrity="sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js" integrity="sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MatchIt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MatchIt.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/matching-methods.html">Matching Methods</a></li>
    <li><a class="dropdown-item" href="../articles/assessing-balance.html">Assessing Balance</a></li>
    <li><a class="dropdown-item" href="../articles/estimating-effects.html">Estimating Effects After Matching</a></li>
    <li><a class="dropdown-item" href="../articles/sampling-weights.html">Matching with Sampling Weights</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kosukeimai/MatchIt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Optimal Full Matching</h1>
      <small class="dont-index">Source: <a href="https://github.com/kosukeimai/MatchIt/blob/master/R/matchit2full.R" class="external-link"><code>R/matchit2full.R</code></a></small>
      <div class="d-none name"><code>method_full.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In <code><a href="matchit.html">matchit()</a></code>, setting <code>method = "full"</code> performs optimal full
matching, which is a form of subclassification wherein all units, both
treatment and control (i.e., the "full" sample), are assigned to a subclass
and receive at least one match. The matching is optimal in the sense that
that sum of the absolute distances between the treated and control units in
each subclass is as small as possible. The method relies on and is a wrapper
for <code><a href="https://rdrr.io/pkg/optmatch/man/fullmatch.html" class="external-link">optmatch::fullmatch()</a></code>.</p>
<p>Advantages of optimal full matching include that the matching order is not
required to be specified, units do not need to be discarded, and it is less
likely that extreme within-subclass distances will be large, unlike with
standard subclassification. The primary output of full matching is a set of
matching weights that can be applied to the matched sample; in this way,
full matching can be seen as a robust alternative to propensity score
weighting, robust in the sense that the propensity score model does not need
to be correct to estimate the treatment effect without bias. Note: with large samples, the optimization may fail or run very slowly; one can try using <code><a href="method_quick.html">method = "quick"</a></code> instead, which also performs full matching but can be much faster.</p>
<p>This page details the allowable arguments with <code>method = "full"</code>.
See <code><a href="matchit.html">matchit()</a></code> for an explanation of what each argument means in a general
context and how it can be specified.</p>
<p>Below is how <code><a href="matchit.html">matchit()</a></code> is used for optimal full matching:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="../reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>        data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"full"</span>,</span>
<span>        distance <span class="op">=</span> <span class="st">"glm"</span>,</span>
<span>        link <span class="op">=</span> <span class="st">"logit"</span>,</span>
<span>        distance.options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        estimand <span class="op">=</span> <span class="st">"ATT"</span>,</span>
<span>        exact <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        mahvars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        anitexact <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        discard <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        reestimate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        caliper <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        std.caliper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        <span class="va">...</span><span class="op">)</span></span></code></pre></div>

    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a two-sided <a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a> object containing the treatment and
covariates to be used in creating the distance measure used in the matching.
This formula will be supplied to the functions that estimate the distance
measure.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame containing the variables named in <code>formula</code>.
If not found in <code>data</code>, the variables will be sought in the
environment.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>set here to <code>"full"</code>.</p></dd>


<dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>the distance measure to be used. See <code><a href="distance.html">distance</a></code>
for allowable options. Can be supplied as a distance matrix.</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>when <code>distance</code> is specified as a method of estimating
propensity scores, an additional argument controlling the link function used
in estimating the distance measure. See <code><a href="distance.html">distance</a></code> for allowable
options with each option.</p></dd>


<dt id="arg-distance-options">distance.options<a class="anchor" aria-label="anchor" href="#arg-distance-options"></a></dt>
<dd><p>a named list containing additional arguments
supplied to the function that estimates the distance measure as determined
by the argument to <code>distance</code>.</p></dd>


<dt id="arg-estimand">estimand<a class="anchor" aria-label="anchor" href="#arg-estimand"></a></dt>
<dd><p>a string containing the desired estimand. Allowable options
include <code>"ATT"</code>, <code>"ATC"</code>, and <code>"ATE"</code>. The estimand controls
how the weights are computed; see the Computing Weights section at
<code><a href="matchit.html">matchit()</a></code> for details.</p></dd>


<dt id="arg-exact">exact<a class="anchor" aria-label="anchor" href="#arg-exact"></a></dt>
<dd><p>for which variables exact matching should take place.</p></dd>


<dt id="arg-mahvars">mahvars<a class="anchor" aria-label="anchor" href="#arg-mahvars"></a></dt>
<dd><p>for which variables Mahalanobis distance matching should take
place when <code>distance</code> corresponds to a propensity score (e.g., for
caliper matching or to discard units for common support). If specified, the
distance measure will not be used in matching.</p></dd>


<dt id="arg-antiexact">antiexact<a class="anchor" aria-label="anchor" href="#arg-antiexact"></a></dt>
<dd><p>for which variables anti-exact matching should take place.
Anti-exact matching is processed using <code><a href="https://rdrr.io/pkg/optmatch/man/antiExactMatch.html" class="external-link">optmatch::antiExactMatch()</a></code>.</p></dd>


<dt id="arg-discard">discard<a class="anchor" aria-label="anchor" href="#arg-discard"></a></dt>
<dd><p>a string containing a method for discarding units outside a
region of common support. Only allowed when <code>distance</code> corresponds to a
propensity score.</p></dd>


<dt id="arg-reestimate">reestimate<a class="anchor" aria-label="anchor" href="#arg-reestimate"></a></dt>
<dd><p>if <code>discard</code> is not <code>"none"</code>, whether to
re-estimate the propensity score in the remaining sample prior to matching.</p></dd>


<dt id="arg-s-weights">s.weights<a class="anchor" aria-label="anchor" href="#arg-s-weights"></a></dt>
<dd><p>the variable containing sampling weights to be incorporated
into propensity score models and balance statistics.</p></dd>


<dt id="arg-caliper">caliper<a class="anchor" aria-label="anchor" href="#arg-caliper"></a></dt>
<dd><p>the width(s) of the caliper(s) used for caliper matching.
Calipers are processed by <code><a href="https://rdrr.io/pkg/optmatch/man/caliper-methods.html" class="external-link">optmatch::caliper()</a></code>. Positive and negative calipers are allowed. See Notes and Examples.</p></dd>


<dt id="arg-std-caliper">std.caliper<a class="anchor" aria-label="anchor" href="#arg-std-caliper"></a></dt>
<dd><p><code>logical</code>; when calipers are specified, whether they
are in standard deviation units (<code>TRUE</code>) or raw units (<code>FALSE</code>).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical</code>; whether information about the matching
process should be printed to the console.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to <code><a href="https://rdrr.io/pkg/optmatch/man/fullmatch.html" class="external-link">optmatch::fullmatch()</a></code>.
Allowed arguments include <code>min.controls</code>, <code>max.controls</code>,
<code>omit.fraction</code>, <code>mean.controls</code>, <code>tol</code>, and <code>solver</code>.
See the <code><a href="https://rdrr.io/pkg/optmatch/man/fullmatch.html" class="external-link">optmatch::fullmatch()</a></code> documentation for details. In general,
<code>tol</code> should be set to a low number (e.g., <code>1e-7</code>) to get a more
precise solution.</p>
<p>The arguments <code>replace</code>, <code>m.order</code>, and <code>ratio</code> are ignored with a warning.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="mahalanobis-distance-matching">Mahalanobis Distance Matching<a class="anchor" aria-label="anchor" href="#mahalanobis-distance-matching"></a></h3>


<p>Mahalanobis distance matching can be done one of two ways:</p>
<ol><li><p>If no propensity score needs to be estimated, <code>distance</code> should be
set to <code>"mahalanobis"</code>, and Mahalanobis distance matching will occur
using all the variables in <code>formula</code>. Arguments to <code>discard</code> and
<code>mahvars</code> will be ignored, and a caliper can only be placed on named
variables. For example, to perform simple Mahalanobis distance matching, the
following could be run:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="../reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span>, method <span class="op">=</span> <span class="st">"nearest"</span>,</span>
<span>        distance <span class="op">=</span> <span class="st">"mahalanobis"</span><span class="op">)</span> </span></code></pre></div>With this code, the Mahalanobis distance is computed using <code>X1</code> and
<code>X2</code>, and matching occurs on this distance. The <code>distance</code>
component of the <code><a href="matchit.html">matchit()</a></code> output will be empty.</li>
<li><p>If a propensity score needs to be estimated for any reason, e.g., for
common support with <code>discard</code> or for creating a caliper,
<code>distance</code> should be whatever method is used to estimate the propensity
score or a vector of distance measures, i.e., it should not be
<code>"mahalanobis"</code>. Use <code>mahvars</code> to specify the variables used to
create the Mahalanobis distance. For example, to perform Mahalanobis within
a propensity score caliper, the following could be run:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="../reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, method <span class="op">=</span> <span class="st">"nearest"</span>,</span>
<span>        distance <span class="op">=</span>  <span class="st">"glm"</span>, caliper <span class="op">=</span> <span class="fl">.25</span>,</span>
<span>        mahvars <span class="op">=</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span><span class="op">)</span> </span></code></pre></div>With this code, <code>X1</code>, <code>X2</code>, and <code>X3</code> are used to estimate the
propensity score (using the <code>"glm"</code> method, which by default is
logistic regression), which is used to create a matching caliper. The actual
matching occurs on the Mahalanobis distance computed only using <code>X1</code>
and <code>X2</code>, which are supplied to <code>mahvars</code>. Units whose propensity
score difference is larger than the caliper will not be paired, and some
treated units may therefore not receive a match. The estimated propensity
scores will be included in the <code>distance</code> component of the
<code><a href="matchit.html">matchit()</a></code> output. See Examples.</li>
</ol></div>

    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Calipers can only be used when <code>min.controls</code> is left at its
default.</p>
<p>The option <code>"optmatch_max_problem_size"</code> is automatically set to
<code>Inf</code> during the matching process, different from its default in
<em>optmatch</em>. This enables matching problems of any size to be run, but
may also let huge, infeasible problems get through and potentially take a
long time or crash R. See <code><a href="https://rdrr.io/pkg/optmatch/man/setMaxProblemSize.html" class="external-link">optmatch::setMaxProblemSize()</a></code> for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a></h2>
    <p>All outputs described in <code><a href="matchit.html">matchit()</a></code> are returned with
<code>method = "full"</code> except for <code>match.matrix</code>. This is because
matching strata are not indexed by treated units as they are in some other
forms of matching. When <code>include.obj = TRUE</code> in the call to
<code><a href="matchit.html">matchit()</a></code>, the output of the call to <code><a href="https://rdrr.io/pkg/optmatch/man/fullmatch.html" class="external-link">optmatch::fullmatch()</a></code> will be
included in the output. When <code>exact</code> is specified, this will be a list
of such objects, one for each stratum of the <code>exact</code> variables.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>In a manuscript, be sure to cite the following paper if using
<code><a href="matchit.html">matchit()</a></code> with <code>method = "full"</code>:</p>
<p>Hansen, B. B., &amp; Klopfer, S. O. (2006). Optimal Full Matching and Related
Designs via Network Flows. <em>Journal of Computational and Graphical Statistics</em>,
15(3), 609–627. <a href="https://doi.org/10.1198/106186006X137047" class="external-link">doi:10.1198/106186006X137047</a></p>
<p>For example, a sentence might read:</p>
<p><em>Optimal full matching was performed using the MatchIt package (Ho,
Imai, King, &amp; Stuart, 2011) in R, which calls functions from the optmatch
package (Hansen &amp; Klopfer, 2006).</em></p>
<p>Theory is also developed in the following article:</p>
<p>Hansen, B. B. (2004). Full Matching in an Observational Study of Coaching
for the SAT. Journal of the American Statistical Association, 99(467),
609–618. <a href="https://doi.org/10.1198/016214504000000647" class="external-link">doi:10.1198/016214504000000647</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="matchit.html">matchit()</a></code> for a detailed explanation of the inputs and outputs of
a call to <code><a href="matchit.html">matchit()</a></code>.</p>
<p><code><a href="https://rdrr.io/pkg/optmatch/man/fullmatch.html" class="external-link">optmatch::fullmatch()</a></code>, which is the workhorse.</p>
<p><code><a href="method_optimal.html">method_optimal</a></code> for optimal pair matching, which is a special
case of optimal full matching, and which relies on similar machinery.
Results from <code>method = "optimal"</code> can be replicated with <code>method = "full"</code> by setting <code>min.controls</code>, <code>max.controls</code>, and
<code>mean.controls</code> to the desired <code>ratio</code>.</p>
<p><code><a href="method_quick.html">method_quick</a></code> for fast generalized quick matching, which is very similar to optimal full matching but can be dramatically faster at the expense of optimality and is less customizable.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Optimal full PS matching</span></span></span>
<span class="r-in"><span><span class="va">m.out1</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                    <span class="va">married</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span></span>
<span class="r-in"><span>                  data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>                  method <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m.out1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `matchit` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: Optimal full matching</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Propensity score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - estimated with logistic regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 614 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, race, nodegree, married, re74, re75</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + race + nodegree + married + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     re74 + re75, data = lalonde, method = "full")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for All Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.5774        0.1822          1.7941     0.9211    0.3774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.8162       28.0303         -0.3094     0.4400    0.0813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.3459       10.2354          0.0550     0.4959    0.0347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8432        0.2028          1.7615          .    0.6404</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0595        0.1422         -0.3498          .    0.0827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.0973        0.6550         -1.8819          .    0.5577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.7081        0.5967          0.2450          .    0.1114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1892        0.5128         -0.8263          .    0.3236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           2095.5737     5619.2365         -0.7211     0.5181    0.2248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1532.0553     2466.4844         -0.2903     0.9563    0.1342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.6444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.1577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.1114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.6404</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.5577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.1114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.3236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.4470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.2876</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.5774        0.5762          0.0054     0.9930    0.0041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.8162       24.8095          0.1407     0.4976    0.0795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.3459       10.3452          0.0004     0.5830    0.0206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8432        0.8347          0.0236          .    0.0086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0595        0.0657         -0.0266          .    0.0063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.0973        0.0996         -0.0078          .    0.0023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.7081        0.7056          0.0056          .    0.0025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1892        0.1368          0.1338          .    0.0524</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           2095.5737     2363.4473         -0.0548     1.1080    0.0424</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1532.0553     1632.4020         -0.0312     1.8588    0.0704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.0486          0.0192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.3131          1.3111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.0548          1.2390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.0086          0.0324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0063          0.5400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.0023          0.3911</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.0025          0.9593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.0524          0.4715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.2492          0.8654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.2366          0.8099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All            429.       185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched (ESS)   52.11     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched        429.       185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched        0.         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded        0.         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Optimal full Mahalanobis distance matching within a PS caliper</span></span></span>
<span class="r-in"><span><span class="va">m.out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                    <span class="va">married</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span></span>
<span class="r-in"><span>                  data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>                  method <span class="op">=</span> <span class="st">"full"</span>,</span></span>
<span class="r-in"><span>                  caliper <span class="op">=</span> <span class="fl">.01</span>,</span></span>
<span class="r-in"><span>                  mahvars <span class="op">=</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m.out2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `matchit` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: Optimal full matching</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Mahalanobis [matching]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Propensity score [caliper]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - estimated with logistic regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - caliper: &lt;distance&gt; (0.003)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 349 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, race, nodegree, married, re74, re75</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out2</span>, un <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + race + nodegree + married + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     re74 + re75, data = lalonde, method = "full", mahvars = ~age + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     educ + re74 + re75, caliper = 0.01)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.5564        0.5566         -0.0012     0.9885    0.0028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.1940       24.4645          0.1020     0.5323    0.0681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.3060       10.5529         -0.1228     0.6813    0.0193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.7985        0.8022         -0.0103          .    0.0037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0672        0.0596          0.0321          .    0.0076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.1343        0.1382         -0.0131          .    0.0039</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.6716        0.6742         -0.0057          .    0.0026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1642        0.1189          0.1157          .    0.0453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           1504.8003     2669.4440         -0.2383     0.4985    0.0889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1242.9898     1479.5812         -0.0735     1.8382    0.0762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.0373          0.0063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.2709          1.1149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.0812          1.1082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.0037          0.0105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0076          0.5788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.0039          0.4490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.0026          0.8782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.0453          0.4951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.3362          0.6849</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.2368          0.6460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All            429.       185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched (ESS)   61.97     134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched        215.       134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched      214.        51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded        0.         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Optimal full Mahalanobis distance matching within calipers</span></span></span>
<span class="r-in"><span><span class="co"># of 500 on re74 and re75</span></span></span>
<span class="r-in"><span><span class="va">m.out3</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span></span>
<span class="r-in"><span>                  data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>                  distance <span class="op">=</span> <span class="st">"mahalanobis"</span>,</span></span>
<span class="r-in"><span>                  method <span class="op">=</span> <span class="st">"full"</span>,</span></span>
<span class="r-in"><span>                  caliper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>re74 <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>                              re75 <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  std.caliper <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m.out3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `matchit` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: Optimal full matching</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Mahalanobis - caliper: re74 (500), re75 (500)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 391 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, re74, re75</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out3</span>,</span></span>
<span class="r-in"><span>        addlvariables <span class="op">=</span> <span class="op">~</span><span class="va">race</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span> <span class="va">married</span>,</span></span>
<span class="r-in"><span>        data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>        un <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + re74 + re75, data = lalonde, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "full", distance = "mahalanobis", caliper = c(re74 = 500, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         re75 = 500), std.caliper = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.8438       26.6668         -0.1150     0.6314    0.0391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.2562       10.2998         -0.0217     0.5406    0.0266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74            902.3844      927.5659         -0.0052     0.9952    0.0089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75            661.1024      674.8033         -0.0043     1.0111    0.0090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8500        0.3065          1.4948          .    0.5435</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0437        0.1258         -0.3469          .    0.0820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.1062        0.5677         -1.5570          .    0.4614</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.7312        0.6768          0.1197          .    0.0544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1625        0.4717         -0.7895          .    0.3092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.0868          0.5037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.0623          0.5850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.1957          0.0249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.0871          0.0421</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.5435          1.7611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0820          0.7605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.4614          1.8935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.0544          0.3086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.3092          1.1113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All            429.       185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched (ESS)   54.18     160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched        231.       160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched      198.        25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded        0.         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Ho, Kosuke Imai, Gary King, Elizabeth Stuart, Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

