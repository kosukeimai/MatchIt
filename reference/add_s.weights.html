<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add sampling weights to a matchit object — add_s.weights • MatchIt</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Add sampling weights to a matchit object — add_s.weights"><meta property="og:description" content="Adds sampling weights to a matchit object so that they are
incorporated into balance assessment and creation of the weights. This would
typically only be used when an argument to s.weights was not supplied
to matchit() (i.e., because they were not to be included in the estimation
of the propensity score) but sampling weights are required for generalizing
an effect to the correct population. Without adding sampling weights to the
matchit object, balance assessment tools (i.e., summary.matchit()
and plot.matchit()) will not calculate balance statistics correctly, and
the weights produced by match.data() and get_matches() will not
incorporate the sampling weights."><meta property="og:image" content="https://kosukeimai.github.io/MatchIt/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MatchIt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.5.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/MatchIt.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/matching-methods.html">Matching Methods</a>
    </li>
    <li>
      <a href="../articles/assessing-balance.html">Assessing Balance</a>
    </li>
    <li>
      <a href="../articles/estimating-effects.html">Estimating Effects After Matching</a>
    </li>
    <li>
      <a href="../articles/sampling-weights.html">Matching with Sampling Weights</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kosukeimai/MatchIt/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add sampling weights to a <code>matchit</code> object</h1>
    <small class="dont-index">Source: <a href="https://github.com/kosukeimai/MatchIt/blob/HEAD/R/add_s.weights.R" class="external-link"><code>R/add_s.weights.R</code></a></small>
    <div class="hidden name"><code>add_s.weights.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Adds sampling weights to a <code>matchit</code> object so that they are
incorporated into balance assessment and creation of the weights. This would
typically only be used when an argument to <code>s.weights</code> was not supplied
to <code><a href="matchit.html">matchit()</a></code> (i.e., because they were not to be included in the estimation
of the propensity score) but sampling weights are required for generalizing
an effect to the correct population. Without adding sampling weights to the
<code>matchit</code> object, balance assessment tools (i.e., <code><a href="summary.matchit.html">summary.matchit()</a></code>
and <code><a href="plot.matchit.html">plot.matchit()</a></code>) will not calculate balance statistics correctly, and
the weights produced by <code><a href="match.data.html">match.data()</a></code> and <code><a href="match.data.html">get_matches()</a></code> will not
incorporate the sampling weights.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_s.weights</span><span class="op">(</span><span class="va">m</span>, s.weights <span class="op">=</span> <span class="cn">NULL</span>, data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>m</dt>
<dd><p>a <code>matchit</code> object; the output of a call to <code><a href="matchit.html">matchit()</a></code>,
typically with the <code>s.weights</code> argument unspecified.</p></dd>


<dt>s.weights</dt>
<dd><p>an numeric vector of sampling weights to be added to the
<code>matchit</code> object. Can also be specified as a string containing the name
of variable in <code>data</code> to be used or a one-sided formula with the
variable on the right-hand side (e.g., <code>~ SW</code>).</p></dd>


<dt>data</dt>
<dd><p>a data frame containing the sampling weights if given as a
string or formula. If unspecified, <code>add_s.weights()</code> will attempt to find
the dataset using the environment of the <code>matchit</code> object.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a <code>matchit</code> object with an <code>s.weights</code> component
containing the supplied sampling weights. If <code>s.weights = NULL</code>, the original
<code>matchit</code> object is returned.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="matchit.html">matchit()</a></code>; <code><a href="match.data.html">match.data()</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Noah Greifer</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate random sampling weights, just</span></span></span>
<span class="r-in"><span><span class="co"># for this example</span></span></span>
<span class="r-in"><span><span class="va">sw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lalonde</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># NN PS match using logistic regression PS that doesn't</span></span></span>
<span class="r-in"><span><span class="co"># include sampling weights</span></span></span>
<span class="r-in"><span><span class="va">m.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                   <span class="va">married</span>  <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>, data <span class="op">=</span> <span class="va">lalonde</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m.out</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A matchit object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: 1:1 nearest neighbor matching without replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Propensity score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - estimated with logistic regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 370 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, race, nodegree, married, re74, re75</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add s.weights to the matchit object</span></span></span>
<span class="r-in"><span><span class="va">m.out</span> <span class="op">&lt;-</span> <span class="fu">add_s.weights</span><span class="op">(</span><span class="va">m.out</span>, <span class="va">sw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m.out</span> <span class="co">#note additional output</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A matchit object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: 1:1 nearest neighbor matching without replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Propensity score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - estimated with logistic regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - sampling weights not included in estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 370 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - sampling weights: present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, race, nodegree, married, re74, re75</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check balance; note that sample sizes incorporate</span></span></span>
<span class="r-in"><span><span class="co"># s.weights</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out</span>, improvement <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + race + nodegree + married + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     re74 + re75, data = lalonde)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for All Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.5700        0.1877          1.8030     0.8514    0.3674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.7699       28.2291         -0.3470     0.4340    0.0894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.5202       10.3026          0.1120     0.5026    0.0298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8508        0.2081          1.8044          .    0.6428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0885        0.1618         -0.2581          .    0.0733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.0607        0.6302         -2.3854          .    0.5695</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.6163        0.5859          0.0625          .    0.0304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1818        0.5003         -0.8261          .    0.3186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           2922.5427     5931.7009         -0.5858     0.5573    0.1823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1794.8248     2580.3949         -0.2155     1.0958    0.1100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.6556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.1908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.1103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.6428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.5695</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.0304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.3186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.3726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.1973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.5700        0.3688          0.9486     0.7563    0.1186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.7699       25.6455          0.0175     0.4043    0.0982</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.5202       10.6603         -0.0721     0.6092    0.0220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8508        0.4685          1.0734          .    0.3824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0885        0.2448         -0.5506          .    0.1564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.0607        0.2867         -0.9467          .    0.2260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.6163        0.6378         -0.0442          .    0.0215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1818        0.1748          0.0180          .    0.0069</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           2922.5427     2472.8799          0.0875     1.4907    0.0477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1794.8248     1733.5764          0.0168     1.6292    0.0299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.4267          1.0121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.3223          1.4027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.0624          1.2631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.3824          1.0470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.1564          0.8756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.2260          1.0189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.0215          0.9226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.0069          0.8130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.2061          0.7763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.1214          0.6670</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All (ESS)      205.31   90.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All            429.    185.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched (ESS)   80.67   90.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched        185.    185.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched      244.      0.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded        0.      0.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Daniel Ho, Kosuke Imai, Gary King, Elizabeth Stuart, Noah Greifer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

