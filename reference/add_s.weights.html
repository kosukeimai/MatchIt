<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Adds sampling weights to a matchit object so that they are
incorporated into balance assessment and creation of the weights. This would
typically only be used when an argument to s.weights was not supplied
to matchit() (i.e., because they were not to be included in the estimation
of the propensity score) but sampling weights are required for generalizing
an effect to the correct population. Without adding sampling weights to the
matchit object, balance assessment tools (i.e., summary.matchit()
and plot.matchit()) will not calculate balance statistics correctly, and
the weights produced by match.data() and get_matches() will not
incorporate the sampling weights."><title>Add sampling weights to a matchit object — add_s.weights • MatchIt</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add sampling weights to a matchit object — add_s.weights"><meta property="og:description" content="Adds sampling weights to a matchit object so that they are
incorporated into balance assessment and creation of the weights. This would
typically only be used when an argument to s.weights was not supplied
to matchit() (i.e., because they were not to be included in the estimation
of the propensity score) but sampling weights are required for generalizing
an effect to the correct population. Without adding sampling weights to the
matchit object, balance assessment tools (i.e., summary.matchit()
and plot.matchit()) will not calculate balance statistics correctly, and
the weights produced by match.data() and get_matches() will not
incorporate the sampling weights."><meta property="og:image" content="https://kosukeimai.github.io/MatchIt/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MatchIt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.5.5.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MatchIt.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/matching-methods.html">Matching Methods</a>
    <a class="dropdown-item" href="../articles/assessing-balance.html">Assessing Balance</a>
    <a class="dropdown-item" href="../articles/estimating-effects.html">Estimating Effects After Matching</a>
    <a class="dropdown-item" href="../articles/sampling-weights.html">Matching with Sampling Weights</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/kosukeimai/MatchIt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add sampling weights to a <code>matchit</code> object</h1>
      <small class="dont-index">Source: <a href="https://github.com/kosukeimai/MatchIt/blob/HEAD/R/add_s.weights.R" class="external-link"><code>R/add_s.weights.R</code></a></small>
      <div class="d-none name"><code>add_s.weights.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Adds sampling weights to a <code>matchit</code> object so that they are
incorporated into balance assessment and creation of the weights. This would
typically only be used when an argument to <code>s.weights</code> was not supplied
to <code><a href="matchit.html">matchit()</a></code> (i.e., because they were not to be included in the estimation
of the propensity score) but sampling weights are required for generalizing
an effect to the correct population. Without adding sampling weights to the
<code>matchit</code> object, balance assessment tools (i.e., <code><a href="summary.matchit.html">summary.matchit()</a></code>
and <code><a href="plot.matchit.html">plot.matchit()</a></code>) will not calculate balance statistics correctly, and
the weights produced by <code><a href="match.data.html">match.data()</a></code> and <code><a href="match.data.html">get_matches()</a></code> will not
incorporate the sampling weights.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_s.weights</span><span class="op">(</span><span class="va">m</span>, s.weights <span class="op">=</span> <span class="cn">NULL</span>, data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>m</dt>
<dd><p>a <code>matchit</code> object; the output of a call to <code><a href="matchit.html">matchit()</a></code>,
typically with the <code>s.weights</code> argument unspecified.</p></dd>


<dt>s.weights</dt>
<dd><p>an numeric vector of sampling weights to be added to the
<code>matchit</code> object. Can also be specified as a string containing the name
of variable in <code>data</code> to be used or a one-sided formula with the
variable on the right-hand side (e.g., <code>~ SW</code>).</p></dd>


<dt>data</dt>
<dd><p>a data frame containing the sampling weights if given as a
string or formula. If unspecified, <code>add_s.weights()</code> will attempt to find
the dataset using the environment of the <code>matchit</code> object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a <code>matchit</code> object with an <code>s.weights</code> component
containing the supplied sampling weights. If <code>s.weights = NULL</code>, the original
<code>matchit</code> object is returned.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="matchit.html">matchit()</a></code>; <code><a href="match.data.html">match.data()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Noah Greifer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate random sampling weights, just</span></span></span>
<span class="r-in"><span><span class="co"># for this example</span></span></span>
<span class="r-in"><span><span class="va">sw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lalonde</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># NN PS match using logistic regression PS that doesn't</span></span></span>
<span class="r-in"><span><span class="co"># include sampling weights</span></span></span>
<span class="r-in"><span><span class="va">m.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                   <span class="va">married</span>  <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>, data <span class="op">=</span> <span class="va">lalonde</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m.out</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A matchit object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: 1:1 nearest neighbor matching without replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Propensity score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - estimated with logistic regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 370 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, race, nodegree, married, re74, re75</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add s.weights to the matchit object</span></span></span>
<span class="r-in"><span><span class="va">m.out</span> <span class="op">&lt;-</span> <span class="fu">add_s.weights</span><span class="op">(</span><span class="va">m.out</span>, <span class="va">sw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m.out</span> <span class="co">#note additional output</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A matchit object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: 1:1 nearest neighbor matching without replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Propensity score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - estimated with logistic regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - sampling weights not included in estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 370 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - sampling weights: present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, race, nodegree, married, re74, re75</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check balance; note that sample sizes incorporate</span></span></span>
<span class="r-in"><span><span class="co"># s.weights</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out</span>, improvement <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + race + nodegree + married + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     re74 + re75, data = lalonde)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for All Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.5796        0.1821          1.7726     0.9548    0.3817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.7457       27.6471         -0.2776     0.3916    0.0917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.2366       10.1874          0.0242     0.5375    0.0324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8523        0.1965          1.8482          .    0.6558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0520        0.1497         -0.4397          .    0.0977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.0957        0.6538         -1.8974          .    0.5581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.7233        0.5991          0.2777          .    0.1242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.2114        0.5043         -0.7175          .    0.2929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           1901.2003     5724.2451         -0.7745     0.4560    0.2349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1423.0173     2586.7575         -0.3786     0.6725    0.1432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.6558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.1616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.1242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.6558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.5581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.1242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.2929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.4843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.3168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.5796        0.3554          0.9999     0.7895    0.1383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.7457       24.6876          0.1545     0.4187    0.0942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.2366       10.5470         -0.1526     0.6304    0.0230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8523        0.4415          1.1577          .    0.4108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0520        0.2361         -0.8285          .    0.1840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.0957        0.3225         -0.7710          .    0.2268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.7233        0.6463          0.1722          .    0.0770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.2114        0.1909          0.0501          .    0.0205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           1901.2003     2115.7108         -0.0435     1.6183    0.0576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1423.0173     1831.8247         -0.1330     1.0301    0.0653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.4342          0.9567</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.3460          1.4563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.0770          1.2332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.4108          1.0511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.1840          1.1438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.2268          0.8453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.0770          1.0271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.0205          0.7944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.3418          0.7885</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.2391          0.7731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All (ESS)      214.55   93.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All            429.    185.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched (ESS)   97.95   93.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched        185.    185.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched      244.      0.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded        0.      0.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Daniel Ho, Kosuke Imai, Gary King, Elizabeth Stuart, Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

