<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Cardinality Matching — method_cardinality • MatchIt</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Cardinality Matching — method_cardinality"><meta property="og:description" content='In matchit(), setting method = "cardinality" performs cardinality
matching and other forms of matching that use mixed integer programming.
Rather than forming pairs, cardinality matching selects the largest subset
of units that satisfies user-supplied balance constraints on mean
differences. One of several available optimization programs can be used to
solve the mixed integer program. The default is the GLPK library as
implemented in the Rglpk package, but performance can be dramatically
improved using Gurobi and the gurobi package, for which there is a
free academic license.
This page details the allowable arguments with method = "cardinality". See matchit() for an explanation of what each argument
means in a general context and how it can be specified.
Below is how matchit() is used for cardinality matching:
matchit(formula,
        data = NULL,
        method = "cardinality",
        estimand = "ATT",
        exact = NULL,
        mahvars = NULL,
        s.weights = NULL,
        ratio = 1,
        verbose = FALSE,
        tols = .05,
        std.tols = TRUE,
        solver = "glpk",
        ...) 
'><meta property="og:image" content="https://kosukeimai.github.io/MatchIt/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MatchIt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.5.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/MatchIt.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/matching-methods.html">Matching Methods</a>
    </li>
    <li>
      <a href="../articles/assessing-balance.html">Assessing Balance</a>
    </li>
    <li>
      <a href="../articles/estimating-effects.html">Estimating Effects After Matching</a>
    </li>
    <li>
      <a href="../articles/sampling-weights.html">Matching with Sampling Weights</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kosukeimai/MatchIt/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cardinality Matching</h1>
    <small class="dont-index">Source: <a href="https://github.com/kosukeimai/MatchIt/blob/HEAD/R/matchit2cardinality.R" class="external-link"><code>R/matchit2cardinality.R</code></a></small>
    <div class="hidden name"><code>method_cardinality.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>In <code><a href="matchit.html">matchit()</a></code>, setting <code>method = "cardinality"</code> performs cardinality
matching and other forms of matching that use mixed integer programming.
Rather than forming pairs, cardinality matching selects the largest subset
of units that satisfies user-supplied balance constraints on mean
differences. One of several available optimization programs can be used to
solve the mixed integer program. The default is the GLPK library as
implemented in the <em>Rglpk</em> package, but performance can be dramatically
improved using Gurobi and the <em>gurobi</em> package, for which there is a
free academic license.</p>
<p>This page details the allowable arguments with <code>method = "cardinality"</code>. See <code><a href="matchit.html">matchit()</a></code> for an explanation of what each argument
means in a general context and how it can be specified.</p>
<p>Below is how <code><a href="matchit.html">matchit()</a></code> is used for cardinality matching:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="../reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>        data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"cardinality"</span>,</span>
<span>        estimand <span class="op">=</span> <span class="st">"ATT"</span>,</span>
<span>        exact <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        mahvars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        tols <span class="op">=</span> <span class="fl">.05</span>,</span>
<span>        std.tols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        solver <span class="op">=</span> <span class="st">"glpk"</span>,</span>
<span>        <span class="va">...</span><span class="op">)</span> </span></code></pre></div>

    </div>


    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>a two-sided <a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a> object containing the treatment and
covariates to be balanced.</p></dd>


<dt>data</dt>
<dd><p>a data frame containing the variables named in <code>formula</code>.
If not found in <code>data</code>, the variables will be sought in the
environment.</p></dd>


<dt>method</dt>
<dd><p>set here to <code>"cardinality"</code>.</p></dd>


<dt>estimand</dt>
<dd><p>a string containing the desired estimand. Allowable options
include <code>"ATT"</code>, <code>"ATC"</code>, and <code>"ATE"</code>. See Details.</p></dd>


<dt>exact</dt>
<dd><p>for which variables exact matching should take place. Separate
optimization will occur within each subgroup of the exact matching
variables.</p></dd>


<dt>mahvars</dt>
<dd><p>which variables should be used for pairing after subset selection. Can only be set when <code>ratio</code> is a whole number. See Details.</p></dd>


<dt>s.weights</dt>
<dd><p>the variable containing sampling weights to be incorporated
into the optimization. The balance constraints refer to the product of the
sampling weights and the matching weights, and the sum of the product of the
sampling and matching weights will be maximized.</p></dd>


<dt>ratio</dt>
<dd><p>the desired ratio of control to treated units. Can be set to
<code>NA</code> to maximize sample size without concern for this ratio. See
Details.</p></dd>


<dt>verbose</dt>
<dd><p><code>logical</code>; whether information about the matching
process should be printed to the console.</p></dd>


<dt>...</dt>
<dd><p>additional arguments that control the matching specification:</p><dl><dt><code>tols</code></dt>
<dd><p><code>numeric</code>; a vector of imbalance
tolerances for mean differences, one for each covariate in <code>formula</code>.
If only one value is supplied, it is applied to all. See <code>std.tols</code>
below. Default is <code>.05</code> for standardized mean differences of at most
.05 for all covariates between the treatment groups in the matched sample.</p></dd>

<dt><code>std.tols</code></dt>
<dd><p><code>logical</code>; whether each entry in <code>tols</code>
corresponds to a raw or standardized mean difference. If only one value is
supplied, it is applied to all. Default is <code>TRUE</code> for standardized mean
differences. The standardization factor is the pooled standard deviation
when <code>estimand = "ATE"</code>, the standard deviation of the treated group
when <code>estimand = "ATT"</code>, and the standard deviation of the control
group when <code>estimand = "ATC"</code> (the same as used in
<code><a href="summary.matchit.html">summary.matchit()</a></code>).</p></dd>

<dt><code>solver</code></dt>
<dd><p>the name of solver to use to
solve the optimization problem. Available options include <code>"glpk"</code>,
<code>"symphony"</code>, and <code>"gurobi"</code> for GLPK (implemented in the
<em>Rglpk</em> package), SYMPHONY (implemented in the <em>Rsymphony</em>
package), and Gurobi (implemented in the <em>gurobi</em> package),
respectively. The differences between them are in speed and solving ability.
GLPK (the default) is the easiest to install, but Gurobi is recommended as
it consistently outperforms other solvers and can find solutions even when
others can't, and in less time. Gurobi is proprietary but can be used with a
free trial or academic license. SYMPHONY may not produce reproducible
results, even with a seed set.</p></dd>

<dt><code>time</code></dt>
<dd><p>the maximum amount of
time before the optimization routine aborts, in seconds. Default is 120 (2
minutes). For large problems, this should be set much higher.</p></dd>


</dl><p>The arguments <code>distance</code> (and related arguments), <code>replace</code>, <code>m.order</code>, and <code>caliper</code> (and related arguments) are ignored with a warning.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    
<div class="section">
<h3 id="cardinality-and-template-matching">Cardinality and Template Matching<a class="anchor" aria-label="anchor" href="#cardinality-and-template-matching"></a></h3>


<p>Two types of matching are
available with <code>method = "cardinality"</code>: cardinality matching and
template matching.</p>
<p><strong>Cardinality matching</strong> finds the largest matched set that satisfies the
balance constraints between treatment groups, with the additional constraint
that the ratio of the number of matched control to matched treated units is
equal to <code>ratio</code> (1 by default), mimicking k:1 matching. When not all
treated units are included in the matched set, the estimand no longer
corresponds to the ATT, so cardinality matching should be avoided if
retaining the ATT is desired. To request cardinality matching,
<code>estimand</code> should be set to <code>"ATT"</code> or <code>"ATC"</code> and
<code>ratio</code> should be set to a positive integer. 1:1 cardinality matching
is the default method when no arguments are specified.</p>
<p><strong>Template matching</strong> finds the largest matched set that satisfies balance
constraints between each treatment group and a specified target sample. When
<code>estimand = "ATT"</code>, it will find the largest subset of the control
units that satisfies the balance constraints with respect to the treated
group, which is left intact. When <code>estimand = "ATE"</code>, it will find the
largest subsets of the treated group and of the control group that are
balanced to the overall sample. To request template matching for the ATT,
<code>estimand</code> should be set to <code>"ATT"</code> and <code>ratio</code> to <code>NA</code>.
To request template matching for the ATE, <code>estimand</code> should be set to
<code>"ATE"</code> and <code>ratio</code> can be set either to <code>NA</code> to maximize the
size of each sample independently or to a positive integer to ensure that
the ratio of matched control units to matched treated treats is fixed,
mimicking k:1 matching. Unlike cardinality matching, template matching
retains the requested estimand if a solution is found.</p>
<p>Neither method involves creating pairs in the matched set, but it is
possible to perform an additional round of pairing within the matched sample
after cardinality matching or template matching for the ATE with a fixed whole number
sample size ratio by supplying the desired pairing variables to <code>mahvars</code>. Doing so will trigger <a href="method_optimal.html">optimal matching</a> using <code><a href="https://rdrr.io/pkg/optmatch/man/pairmatch.html" class="external-link">optmatch::pairmatch()</a></code> on the Mahalanobis distance computed using the variables supplied to <code>mahvars</code>. The balance or composition of the matched sample will not change, but additional
precision and robustness can be gained by forming the pairs.</p>
<p>The weights are scaled so that the sum of the weights in each group is equal
to the number of matched units in the smaller group when cardinality
matching or template matching for the ATE, and scaled so that the sum of the
weights in the control group is equal to the number of treated units when
template matching for the ATT. When the sample sizes of the matched groups
is the same (i.e., when <code>ratio = 1</code>), no scaling is done. Robust
standard errors should be used in effect estimation after cardinality or
template matching (and cluster-robust standard errors if additional pairing
is done in the matched sample). See <code><a href="../articles/estimating-effects.html">vignette("estimating-effects")</a></code>
for more information.</p>
</div>

<div class="section">
<h3 id="specifying-balance-constraints">Specifying Balance Constraints<a class="anchor" aria-label="anchor" href="#specifying-balance-constraints"></a></h3>


<p>The balance constraints are on
the (standardized) mean differences between the matched treatment groups for
each covariate. Balance constraints should be set by supplying arguments to
<code>tols</code> and <code>std.tols</code>. For example, setting <code>tols = .1</code> and
<code>std.tols = TRUE</code> requests that all the mean differences in the matched
sample should be within .1 standard deviations for each covariate. Different
tolerances can be set for different variables; it might be beneficial to
constrain the mean differences for highly prognostic covariates more tightly
than for other variables. For example, one could specify <code>tols = c(.001, .05), std.tols = c(TRUE, FALSE)</code>
to request that the standardized
mean difference for the first covariate is less than .001 and the raw mean
difference for the second covariate is less than .05. The values should be
specified in the order they appear in <code>formula</code>, except when
interactions are present. One can run the following code:</p>
<div class="sourceCode"><pre><code><span><span class="fu">MatchIt</span><span class="fu">:::</span><span class="fu">get_assign</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">X1</span><span class="op">*</span><span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>

<p>which will output a vector of numbers and the variable to which each number
corresponds; the first entry in <code>tols</code> corresponds to the variable
labeled 1, the second to the variable labeled 2, etc.</p>
</div>

<div class="section">
<h3 id="dealing-with-errors-and-warnings">Dealing with Errors and Warnings<a class="anchor" aria-label="anchor" href="#dealing-with-errors-and-warnings"></a></h3>


<p>When the optimization cannot be
solved at all, or at least within the time frame specified in the argument
to <code>time</code>, an error or warning will appear. Unfortunately, it is hard
to know exactly the cause of the failure and what measures should be taken
to rectify it.</p>
<p>A warning that says <code>"The optimizer failed to find an optimal solution in the time alotted. The returned solution may not be optimal."</code> usually
means that an optimal solution may be possible to find with more time, in
which case <code>time</code> should be increased or a faster solver should be
used. Even with this warning, a potentially usable solution will be
returned, so don't automatically take it to mean the optimization failed.
Sometimes, when there are multiple solutions with the same resulting sample
size, the optimizers will stall at one of them, not thinking it has found
the optimum. The result should be checked to see if it can be used as the
solution.</p>
<p>An error that says <code>"The optimization problem may be infeasible."</code>
usually means that there is a issue with the optimization problem, i.e.,
that there is no possible way to satisfy the constraints. To rectify this,
one can try relaxing the constraints by increasing the value of <code>tols</code>
or use another solver. Sometimes Gurobi can solve problems that the other
solvers cannot.</p>
</div>

    </div>
    <div id="outputs">
    <h2>Outputs</h2>
    


<p>Most outputs described in <code><a href="matchit.html">matchit()</a></code> are returned with
<code>method = "cardinality"</code>. Unless <code>mahvars</code> is specified, the <code>match.matrix</code> and <code>subclass</code>
components are omitted because no pairing or subclassification is done. When
<code>include.obj = TRUE</code> in the call to <code><a href="matchit.html">matchit()</a></code>, the output of the
optimization function will be included in the output. When <code>exact</code> is
specified, this will be a list of such objects, one for each stratum of the
exact variables.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>In a manuscript, you should reference the solver used in the
optimization. For example, a sentence might read:</p>
<p><em>Cardinality matching was performed using the MatchIt package (Ho,
Imai, King, &amp; Stuart, 2011) in R with the optimization performed by GLPK.</em></p>
<p>See <code><a href="../articles/matching-methods.html">vignette("matching-methods")</a></code> for more literature on cardinality
matching.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="matchit.html">matchit()</a></code> for a detailed explanation of the inputs and outputs of
a call to <code><a href="matchit.html">matchit()</a></code>.</p>
<p><em><a href="https://CRAN.R-project.org/package=designmatch" class="external-link"><span class="pkg">designmatch</span></a></em>, which performs cardinality and template matching with many more options and
more flexibility. The implementations of cardinality matching differ between
<em>MatchIt</em> and <em>designmatch</em>, so their results might differ.</p>
<p><em><a href="https://CRAN.R-project.org/package=optweight" class="external-link"><span class="pkg">optweight</span></a></em>, which offers similar functionality but in the context of weighting rather
than matching.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Choose your solver; "gurobi" is best, "glpk" is free and</span></span></span>
<span class="r-in"><span><span class="co">#easiest to install</span></span></span>
<span class="r-in"><span><span class="va">solver</span> <span class="op">&lt;-</span> <span class="st">"glpk"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1:1 cardinality matching</span></span></span>
<span class="r-in"><span><span class="va">m.out1</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">re74</span>,</span></span>
<span class="r-in"><span>                  data <span class="op">=</span> <span class="va">lalonde</span>, method <span class="op">=</span> <span class="st">"cardinality"</span>,</span></span>
<span class="r-in"><span>                  estimand <span class="op">=</span> <span class="st">"ATT"</span>, ratio <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                  tols <span class="op">=</span> <span class="fl">.15</span>, solver <span class="op">=</span> <span class="va">solver</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m.out1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A matchit object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: Cardinality matching</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 370 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, re74</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + re74, data = lalonde, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "cardinality", estimand = "ATT", ratio = 1, tols = 0.15, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     solver = solver)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for All Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age        25.8162       28.0303         -0.3094     0.4400    0.0813   0.1577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ       10.3459       10.2354          0.0550     0.4959    0.0347   0.1114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74     2095.5737     5619.2365         -0.7211     0.5181    0.2248   0.4470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age        25.8162       26.8811         -0.1488     0.4861    0.0685   0.1459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ       10.3459       10.0486          0.1479     0.4197    0.0441   0.1351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74     2095.5737     2817.4574         -0.1477     0.8712    0.0695   0.3297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All           429     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched       185     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched     244       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Template matching for the ATT</span></span></span>
<span class="r-in"><span><span class="va">m.out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">re74</span>,</span></span>
<span class="r-in"><span>                  data <span class="op">=</span> <span class="va">lalonde</span>, method <span class="op">=</span> <span class="st">"cardinality"</span>,</span></span>
<span class="r-in"><span>                  estimand <span class="op">=</span> <span class="st">"ATT"</span>, ratio <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>                  tols <span class="op">=</span> <span class="fl">.15</span>, solver <span class="op">=</span> <span class="va">solver</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m.out2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A matchit object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: Cardinality matching</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 531 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, re74</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out2</span>, un <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + re74, data = lalonde, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "cardinality", estimand = "ATT", ratio = NA, tols = 0.15, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     solver = solver)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age        25.8162       26.2601         -0.0620     0.4780    0.0700   0.1684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ       10.3459       10.0520          0.1462     0.4694    0.0384   0.1145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74     2095.5737     2828.3489         -0.1500     1.9669    0.1218   0.3844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All           429     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched       346     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched      83       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Template matching for the ATE</span></span></span>
<span class="r-in"><span><span class="va">m.out3</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">re74</span>,</span></span>
<span class="r-in"><span>                  data <span class="op">=</span> <span class="va">lalonde</span>, method <span class="op">=</span> <span class="st">"cardinality"</span>,</span></span>
<span class="r-in"><span>                  estimand <span class="op">=</span> <span class="st">"ATE"</span>, ratio <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>                  tols <span class="op">=</span> <span class="fl">.15</span>, solver <span class="op">=</span> <span class="va">solver</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m.out3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A matchit object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: Cardinality matching</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 509 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, re74</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out3</span>, un <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + re74, data = lalonde, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "cardinality", estimand = "ATE", ratio = NA, tols = 0.15, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     solver = solver)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age        26.9574       27.7349         -0.0849     0.5222    0.0611   0.1282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ       10.4468       10.1735          0.1107     0.4874    0.0318   0.1017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74     4115.1370     5000.8609         -0.1498     1.0940    0.0667   0.1663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All           429     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched       415      94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched      14      91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Pairing after 1:1 cardinality matching:</span></span></span>
<span class="r-in"><span><span class="va">m.out1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">re74</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">lalonde</span>, method <span class="op">=</span> <span class="st">"cardinality"</span>,</span></span>
<span class="r-in"><span>                   estimand <span class="op">=</span> <span class="st">"ATT"</span>, ratio <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   tols <span class="op">=</span> <span class="fl">.15</span>, solver <span class="op">=</span> <span class="va">solver</span>,</span></span>
<span class="r-in"><span>                   mahvars <span class="op">=</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">re74</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that balance doesn't change but pair distances</span></span></span>
<span class="r-in"><span><span class="co"># are lower for the paired-upon variables</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out1b</span>, un <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + re74, data = lalonde, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "cardinality", estimand = "ATT", mahvars = ~age + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         educ + re74, ratio = 1, tols = 0.15, solver = solver)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age        25.8162       26.8811         -0.1488     0.4861    0.0685   0.1459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ       10.3459       10.0486          0.1479     0.4197    0.0441   0.1351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74     2095.5737     2817.4574         -0.1477     0.8712    0.0695   0.3297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age           0.4525</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ          0.5027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74          0.2470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All           429     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched       185     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched     244       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out1</span>, un <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + re74, data = lalonde, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "cardinality", estimand = "ATT", ratio = 1, tols = 0.15, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     solver = solver)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age        25.8162       26.8811         -0.1488     0.4861    0.0685   0.1459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ       10.3459       10.0486          0.1479     0.4197    0.0441   0.1351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74     2095.5737     2817.4574         -0.1477     0.8712    0.0695   0.3297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All           429     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched       185     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched     244       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In these examples, a high tol was used and</span></span></span>
<span class="r-in"><span><span class="co"># few covariate matched on in order to not take too long;</span></span></span>
<span class="r-in"><span><span class="co"># with real data, tols should be much lower and more</span></span></span>
<span class="r-in"><span><span class="co"># covariates included if possible.</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Daniel Ho, Kosuke Imai, Gary King, Elizabeth Stuart, Noah Greifer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

