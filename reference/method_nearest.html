<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Nearest Neighbor Matching — method_nearest • MatchIt</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Nearest Neighbor Matching — method_nearest"><meta name="description" content='In matchit(), setting method = "nearest" performs greedy nearest
neighbor matching. A distance is computed between each treated unit and each
control unit, and, one by one, each treated unit is assigned a control unit
as a match. The matching is "greedy" in the sense that there is no action
taken to optimize an overall criterion; each match is selected without
considering the other matches that may occur subsequently.
This page details the allowable arguments with method = "nearest".
See matchit() for an explanation of what each argument means in a general
context and how it can be specified.
Below is how matchit() is used for nearest neighbor matching:
matchit(formula,
        data = NULL,
        method = "nearest",
        distance = "glm",
        link = "logit",
        distance.options = list(),
        estimand = "ATT",
        exact = NULL,
        mahvars = NULL,
        antiexact = NULL,
        discard = "none",
        reestimate = FALSE,
        s.weights = NULL,
        replace = TRUE,
        m.order = NULL,
        caliper = NULL,
        ratio = 1,
        min.controls = NULL,
        max.controls = NULL,
        verbose = FALSE,
        ...)
'><meta property="og:description" content='In matchit(), setting method = "nearest" performs greedy nearest
neighbor matching. A distance is computed between each treated unit and each
control unit, and, one by one, each treated unit is assigned a control unit
as a match. The matching is "greedy" in the sense that there is no action
taken to optimize an overall criterion; each match is selected without
considering the other matches that may occur subsequently.
This page details the allowable arguments with method = "nearest".
See matchit() for an explanation of what each argument means in a general
context and how it can be specified.
Below is how matchit() is used for nearest neighbor matching:
matchit(formula,
        data = NULL,
        method = "nearest",
        distance = "glm",
        link = "logit",
        distance.options = list(),
        estimand = "ATT",
        exact = NULL,
        mahvars = NULL,
        antiexact = NULL,
        discard = "none",
        reestimate = FALSE,
        s.weights = NULL,
        replace = TRUE,
        m.order = NULL,
        caliper = NULL,
        ratio = 1,
        min.controls = NULL,
        max.controls = NULL,
        verbose = FALSE,
        ...)
'><meta property="og:image" content="https://kosukeimai.github.io/MatchIt/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MatchIt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MatchIt.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/matching-methods.html">Matching Methods</a></li>
    <li><a class="dropdown-item" href="../articles/assessing-balance.html">Assessing Balance</a></li>
    <li><a class="dropdown-item" href="../articles/estimating-effects.html">Estimating Effects After Matching</a></li>
    <li><a class="dropdown-item" href="../articles/sampling-weights.html">Matching with Sampling Weights</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kosukeimai/MatchIt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Nearest Neighbor Matching</h1>
      <small class="dont-index">Source: <a href="https://github.com/kosukeimai/MatchIt/blob/master/R/matchit2nearest.R" class="external-link"><code>R/matchit2nearest.R</code></a></small>
      <div class="d-none name"><code>method_nearest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In <code><a href="matchit.html">matchit()</a></code>, setting <code>method = "nearest"</code> performs greedy nearest
neighbor matching. A distance is computed between each treated unit and each
control unit, and, one by one, each treated unit is assigned a control unit
as a match. The matching is "greedy" in the sense that there is no action
taken to optimize an overall criterion; each match is selected without
considering the other matches that may occur subsequently.</p>
<p>This page details the allowable arguments with <code>method = "nearest"</code>.
See <code><a href="matchit.html">matchit()</a></code> for an explanation of what each argument means in a general
context and how it can be specified.</p>
<p>Below is how <code><a href="matchit.html">matchit()</a></code> is used for nearest neighbor matching:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="../reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>        data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"nearest"</span>,</span>
<span>        distance <span class="op">=</span> <span class="st">"glm"</span>,</span>
<span>        link <span class="op">=</span> <span class="st">"logit"</span>,</span>
<span>        distance.options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        estimand <span class="op">=</span> <span class="st">"ATT"</span>,</span>
<span>        exact <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        mahvars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        antiexact <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        discard <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        reestimate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        replace <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        m.order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        caliper <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        min.controls <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        max.controls <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        <span class="va">...</span><span class="op">)</span> </span></code></pre></div>

    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a two-sided <a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a> object containing the treatment and
covariates to be used in creating the distance measure used in the matching.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame containing the variables named in <code>formula</code>.
If not found in <code>data</code>, the variables will be sought in the
environment.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>set here to <code>"nearest"</code>.</p></dd>


<dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>the distance measure to be used. See <code><a href="distance.html">distance</a></code>
for allowable options. Can be supplied as a distance matrix.</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>when <code>distance</code> is specified as a method of estimating
propensity scores, an additional argument controlling the link function used
in estimating the distance measure. See <code><a href="distance.html">distance</a></code> for allowable
options with each option.</p></dd>


<dt id="arg-distance-options">distance.options<a class="anchor" aria-label="anchor" href="#arg-distance-options"></a></dt>
<dd><p>a named list containing additional arguments
supplied to the function that estimates the distance measure as determined
by the argument to <code>distance</code>.</p></dd>


<dt id="arg-estimand">estimand<a class="anchor" aria-label="anchor" href="#arg-estimand"></a></dt>
<dd><p>a string containing the desired estimand. Allowable options
include <code>"ATT"</code> and <code>"ATC"</code>. See Details.</p></dd>


<dt id="arg-exact">exact<a class="anchor" aria-label="anchor" href="#arg-exact"></a></dt>
<dd><p>for which variables exact matching should take place; two units with different values of an exact matching variable will not be paired.</p></dd>


<dt id="arg-mahvars">mahvars<a class="anchor" aria-label="anchor" href="#arg-mahvars"></a></dt>
<dd><p>for which variables Mahalanobis distance matching should take
place when <code>distance</code> corresponds to a propensity score (e.g., for
caliper matching or to discard units for common support). If specified, the
distance measure will not be used in matching.</p></dd>


<dt id="arg-antiexact">antiexact<a class="anchor" aria-label="anchor" href="#arg-antiexact"></a></dt>
<dd><p>for which variables anti-exact matching should take place; two units with the same value of an anti-exact matching variable will not be paired.</p></dd>


<dt id="arg-discard">discard<a class="anchor" aria-label="anchor" href="#arg-discard"></a></dt>
<dd><p>a string containing a method for discarding units outside a
region of common support. Only allowed when <code>distance</code> corresponds to a
propensity score.</p></dd>


<dt id="arg-reestimate">reestimate<a class="anchor" aria-label="anchor" href="#arg-reestimate"></a></dt>
<dd><p>if <code>discard</code> is not <code>"none"</code>, whether to
re-estimate the propensity score in the remaining sample prior to matching.</p></dd>


<dt id="arg-s-weights">s.weights<a class="anchor" aria-label="anchor" href="#arg-s-weights"></a></dt>
<dd><p>the variable containing sampling weights to be incorporated
into propensity score models and balance statistics.</p></dd>


<dt id="arg-replace">replace<a class="anchor" aria-label="anchor" href="#arg-replace"></a></dt>
<dd><p>whether matching should be done with replacement (i.e., whether control units can be used as matches multiple times). See also the <code>reuse.max</code> argument below. Default is <code>FALSE</code> for matching without replacement.</p></dd>


<dt id="arg-m-order">m.order<a class="anchor" aria-label="anchor" href="#arg-m-order"></a></dt>
<dd><p>the order that the matching takes place. Allowable options
include <code>"largest"</code>, where matching takes place in descending order of
distance measures; <code>"smallest"</code>, where matching takes place in ascending
order of distance measures; <code>"closest"</code>, where matching takes place in
ascending order of the smallest distance between units; <code>"farthest"</code>, where matching takes place in
descending order of the smallest distance between units; <code>"random"</code>, where matching takes place
in a random order; and <code>"data"</code> where matching takes place based on the
order of units in the data. When <code>m.order = "random"</code>, results may differ
across different runs of the same code unless a seed is set and specified
with <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>. The default of <code>NULL</code> corresponds to <code>"largest"</code> when a
propensity score is estimated or supplied as a vector and <code>"data"</code>
otherwise. See Details for more information.</p></dd>


<dt id="arg-caliper">caliper<a class="anchor" aria-label="anchor" href="#arg-caliper"></a></dt>
<dd><p>the width(s) of the caliper(s) used for caliper matching. Two units with a difference on a caliper variable larger than the caliper will not be paired. See Details and Examples.</p></dd>


<dt id="arg-std-caliper">std.caliper<a class="anchor" aria-label="anchor" href="#arg-std-caliper"></a></dt>
<dd><p><code>logical</code>; when calipers are specified, whether they
are in standard deviation units (<code>TRUE</code>) or raw units (<code>FALSE</code>).</p></dd>


<dt id="arg-ratio">ratio<a class="anchor" aria-label="anchor" href="#arg-ratio"></a></dt>
<dd><p>how many control units should be matched to each treated unit
for k:1 matching. For variable ratio matching, see section "Variable Ratio
Matching" in Details below. When <code>ratio</code> is greater than 1, all treated units will be attempted to be matched with a control unit before any treated unit is matched with a second control unit, etc. This reduces the possibility that control units will be used up before some treated units receive any matches.</p></dd>


<dt id="arg-min-controls-max-controls">min.controls, max.controls<a class="anchor" aria-label="anchor" href="#arg-min-controls-max-controls"></a></dt>
<dd><p>for variable ratio matching, the minimum
and maximum number of controls units to be matched to each treated unit. See
section "Variable Ratio Matching" in Details below.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical</code>; whether information about the matching
process should be printed to the console. When <code>TRUE</code>, a progress bar
implemented using <em>RcppProgress</em> will be displayed along with an estimate of the time remaining.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments that control the matching specification:</p><dl><dt><code>reuse.max</code></dt>
<dd><p><code>numeric</code>; the maximum number of
times each control can be used as a match. Setting <code>reuse.max = 1</code>
corresponds to matching without replacement (i.e., <code>replace = FALSE</code>),
and setting <code>reuse.max = Inf</code> corresponds to traditional matching with
replacement (i.e., <code>replace = TRUE</code>) with no limit on the number of
times each control unit can be matched. Other values restrict the number of
times each control can be matched when matching with replacement.
<code>replace</code> is ignored when <code>reuse.max</code> is specified.</p></dd>

<dt><code>unit.id</code></dt>
<dd><p>one or more variables containing a unit ID for each
observation, i.e., in case multiple observations correspond to the same
unit. Once a control observation has been matched, no other observation with
the same unit ID can be used as matches. This ensures each control unit is
used only once even if it has multiple observations associated with it.
Omitting this argument is the same as giving each observation a unique ID.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="mahalanobis-distance-matching">Mahalanobis Distance Matching<a class="anchor" aria-label="anchor" href="#mahalanobis-distance-matching"></a></h3>


<p>Mahalanobis distance matching can be done one of two ways:</p><ol><li><p>If no propensity score needs to be estimated, <code>distance</code> should be
set to <code>"mahalanobis"</code>, and Mahalanobis distance matching will occur
using all the variables in <code>formula</code>. Arguments to <code>discard</code> and
<code>mahvars</code> will be ignored, and a caliper can only be placed on named
variables. For example, to perform simple Mahalanobis distance matching, the
following could be run:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="../reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span>, method <span class="op">=</span> <span class="st">"nearest"</span>,</span>
<span>        distance <span class="op">=</span> <span class="st">"mahalanobis"</span><span class="op">)</span> </span></code></pre></div>With this code, the Mahalanobis distance is computed using <code>X1</code> and
<code>X2</code>, and matching occurs on this distance. The <code>distance</code>
component of the <code><a href="matchit.html">matchit()</a></code> output will be empty.</li>
<li><p>If a propensity score needs to be estimated for any reason, e.g., for
common support with <code>discard</code> or for creating a caliper,
<code>distance</code> should be whatever method is used to estimate the propensity
score or a vector of distance measures. Use <code>mahvars</code> to specify the
variables used to create the Mahalanobis distance. For example, to perform
Mahalanobis within a propensity score caliper, the following could be run:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="../reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, method <span class="op">=</span> <span class="st">"nearest"</span>,</span>
<span>        distance <span class="op">=</span> <span class="st">"glm"</span>, caliper <span class="op">=</span> <span class="fl">.25</span>,</span>
<span>        mahvars <span class="op">=</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span><span class="op">)</span> </span></code></pre></div>With this code, <code>X1</code>, <code>X2</code>, and <code>X3</code> are used to estimate the
propensity score (using the <code>"glm"</code> method, which by default is
logistic regression), which is used to create a matching caliper. The actual
matching occurs on the Mahalanobis distance computed only using <code>X1</code>
and <code>X2</code>, which are supplied to <code>mahvars</code>. Units whose propensity
score difference is larger than the caliper will not be paired, and some
treated units may therefore not receive a match. The estimated propensity
scores will be included in the <code>distance</code> component of the
<code><a href="matchit.html">matchit()</a></code> output. See Examples.</li>
</ol></div>

<div class="section">
<h3 id="estimand">Estimand<a class="anchor" aria-label="anchor" href="#estimand"></a></h3>


<p>The <code>estimand</code> argument controls whether control units are selected to be
matched with treated units (<code>estimand = "ATT"</code>) or treated units are
selected to be matched with control units (<code>estimand = "ATC"</code>). The
"focal" group (e.g., the treated units for the ATT) is typically made to be
the smaller treatment group, and a warning will be thrown if it is not set
that way unless <code>replace = TRUE</code>. Setting <code>estimand = "ATC"</code> is
equivalent to swapping all treated and control labels for the treatment
variable. When <code>estimand = "ATC"</code>, the default <code>m.order</code> is
<code>"smallest"</code>, and the <code>match.matrix</code> component of the output will
have the names of the control units as the rownames and be filled with the
names of the matched treated units (opposite to when <code>estimand = "ATT"</code>). Note that the argument supplied to <code>estimand</code> doesn't
necessarily correspond to the estimand actually targeted; it is merely a
switch to trigger which treatment group is considered "focal".</p>
</div>

<div class="section">
<h3 id="variable-ratio-matching">Variable Ratio Matching<a class="anchor" aria-label="anchor" href="#variable-ratio-matching"></a></h3>


<p><code><a href="matchit.html">matchit()</a></code> can perform variable ratio "extremal" matching as described by Ming and Rosenbaum (2000; <a href="https://doi.org/10.1111/j.0006-341X.2000.00118.x" class="external-link">doi:10.1111/j.0006-341X.2000.00118.x</a>
). This
method tends to result in better balance than fixed ratio matching at the
expense of some precision. When <code>ratio &gt; 1</code>, rather than requiring all
treated units to receive <code>ratio</code> matches, each treated unit is assigned
a value that corresponds to the number of control units they will be matched
to. These values are controlled by the arguments <code>min.controls</code> and
<code>max.controls</code>, which correspond to \(\alpha\) and \(\beta\),
respectively, in Ming and Rosenbaum (2000), and trigger variable ratio
matching to occur. Some treated units will receive <code>min.controls</code>
matches and others will receive <code>max.controls</code> matches (and one unit
may have an intermediate number of matches); how many units are assigned
each number of matches is determined by the algorithm described in Ming and
Rosenbaum (2000, p119). <code>ratio</code> controls how many total control units
will be matched: <code>n1 * ratio</code> control units will be matched, where
<code>n1</code> is the number of treated units, yielding the same total number of
matched controls as fixed ratio matching does.</p>
<p>Variable ratio matching cannot be used with Mahalanobis distance matching or
when <code>distance</code> is supplied as a matrix. The calculations of the
numbers of control units each treated unit will be matched to occurs without
consideration of <code>caliper</code> or <code>discard</code>. <code>ratio</code> does not
have to be an integer but must be greater than 1 and less than <code>n0/n1</code>,
where <code>n0</code> and <code>n1</code> are the number of control and treated units,
respectively. Setting <code>ratio = n0/n1</code> performs a crude form of full
matching where all control units are matched. If <code>min.controls</code> is not
specified, it is set to 1 by default. <code>min.controls</code> must be less than
<code>ratio</code>, and <code>max.controls</code> must be greater than <code>ratio</code>. See
Examples below for an example of their use.</p>
</div>

<div class="section">
<h3 id="using-m-order-closest-or-farthest-">Using <code>m.order = "closest"</code> or <code>"farthest"</code><a class="anchor" aria-label="anchor" href="#using-m-order-closest-or-farthest-"></a></h3>


<p><code>m.order</code> can be set to <code>"closest"</code> or <code>"farthest"</code>, which work regardless of how the distance measure is specified. This matches in order of the distance between units. First, all the closest match is found for all treated units and the pairwise distances computed; when <code>m.order = "closest"</code> the pair with the smallest of the distances is matched first, and when <code>m.order = "farthest"</code>, the pair with the largest of the distances is matched first. Then, the pair with the second smallest (or largest) is matched second. If the matched control is ineligible (i.e., because it has already been used in a prior match), a new match is found for the treated unit, the new pair's distance is re-computed, and the pairs are re-ordered by distance.</p>
<p>Using <code>m.order = "closest"</code> ensures that the best possible matches are given priority, and in that sense should perform similarly to <code>m.order = "smallest"</code>. It can be used to ensure the best matches, especially when matching with a caliper. Using <code>m.order = "farthest"</code> ensures that the hardest units to match are given their best chance to find a close match, and in that sense should perform similarly to <code>m.order = "largest"</code>. It can be used to reduce the possibility of extreme imbalance when there are hard-to-match units competing for controls. Note that <code>m.order = "farthest"</code> <strong>does not</strong> implement "far matching" (i.e., finding the farthest control unit from each treated unit); it defines the order in which the closest matches are selected.</p>
</div>

<div class="section">
<h3 id="reproducibility">Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"></a></h3>


<p>Nearest neighbor matching involves a random component only when <code>m.order = "random"</code> (or when the propensity is estimated using a method with randomness; see <code><a href="distance.html">distance</a></code> for details), so a seed must be set in that case using <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> to ensure reproducibility. Otherwise, it is purely deterministic, and any ties are broken based on the order in which the data appear.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a></h2>


<p>All outputs described in <code><a href="matchit.html">matchit()</a></code> are returned with
<code>method = "nearest"</code>. When <code>replace = TRUE</code>, the <code>subclass</code>
component is omitted. <code>include.obj</code> is ignored.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>In a manuscript, you don't need to cite another package when
using <code>method = "nearest"</code> because the matching is performed completely
within <em>MatchIt</em>. For example, a sentence might read:</p>
<p><em>Nearest neighbor matching was performed using the MatchIt package (Ho, Imai, King, &amp; Stuart, 2011) in R.</em></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="matchit.html">matchit()</a></code> for a detailed explanation of the inputs and outputs of
a call to <code><a href="matchit.html">matchit()</a></code>.</p>
<p><code><a href="method_optimal.html">method_optimal()</a></code> for optimal pair matching, which is similar to
nearest neighbor matching without replacement except that an overall distance criterion is
minimized (i.e., as an alternative to specifying <code>m.order</code>).</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1:1 greedy NN matching on the PS</span></span></span>
<span class="r-in"><span><span class="va">m.out1</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                    <span class="va">married</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span></span>
<span class="r-in"><span>                  data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>                  method <span class="op">=</span> <span class="st">"nearest"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m.out1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `matchit` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: 1:1 nearest neighbor matching without replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Propensity score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - estimated with logistic regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 370 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, race, nodegree, married, re74, re75</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + race + nodegree + married + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     re74 + re75, data = lalonde, method = "nearest")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for All Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.5774        0.1822          1.7941     0.9211    0.3774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.8162       28.0303         -0.3094     0.4400    0.0813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.3459       10.2354          0.0550     0.4959    0.0347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8432        0.2028          1.7615          .    0.6404</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0595        0.1422         -0.3498          .    0.0827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.0973        0.6550         -1.8819          .    0.5577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.7081        0.5967          0.2450          .    0.1114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1892        0.5128         -0.8263          .    0.3236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           2095.5737     5619.2365         -0.7211     0.5181    0.2248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1532.0553     2466.4844         -0.2903     0.9563    0.1342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.6444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.1577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.1114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.6404</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.5577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.1114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.3236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.4470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.2876</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.5774        0.3629          0.9739     0.7566    0.1321</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.8162       25.3027          0.0718     0.4568    0.0847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.3459       10.6054         -0.1290     0.5721    0.0239</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8432        0.4703          1.0259          .    0.3730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0595        0.2162         -0.6629          .    0.1568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.0973        0.3135         -0.7296          .    0.2162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.7081        0.6378          0.1546          .    0.0703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1892        0.2108         -0.0552          .    0.0216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           2095.5737     2342.1076         -0.0505     1.3289    0.0469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1532.0553     1614.7451         -0.0257     1.4956    0.0452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.4216          0.9740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.2541          1.3938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.0757          1.2474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.3730          1.0259</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.1568          1.0743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.2162          0.8390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.0703          1.0106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.0216          0.8281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.2757          0.7965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.2054          0.7381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All           429     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched       185     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched     244       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3:1 NN Mahalanobis distance matching with</span></span></span>
<span class="r-in"><span><span class="co"># replacement within a PS caliper</span></span></span>
<span class="r-in"><span><span class="va">m.out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                    <span class="va">married</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span></span>
<span class="r-in"><span>                  data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>                  method <span class="op">=</span> <span class="st">"nearest"</span>,</span></span>
<span class="r-in"><span>                  replace <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                  mahvars <span class="op">=</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span></span>
<span class="r-in"><span>                  ratio <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                  caliper <span class="op">=</span> <span class="fl">.02</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m.out2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `matchit` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: 3:1 nearest neighbor matching with replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Mahalanobis [matching]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Propensity score [caliper]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - estimated with logistic regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - caliper: &lt;distance&gt; (0.006)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 300 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, race, nodegree, married, re74, re75</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out2</span>, un <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + race + nodegree + married + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     re74 + re75, data = lalonde, method = "nearest", mahvars = ~age + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     educ + re74 + re75, replace = TRUE, caliper = 0.02, ratio = 3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.5660        0.5660          0.0003     0.9880    0.0037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.5000       24.0010          0.2095     0.5178    0.0835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.3086       10.3930         -0.0420     0.7356    0.0115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8210        0.8169          0.0113          .    0.0041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0679        0.0576          0.0435          .    0.0103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.1111        0.1255         -0.0486          .    0.0144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.7037        0.6852          0.0407          .    0.0185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1914        0.1132          0.1996          .    0.0782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           1831.9348     2119.9268         -0.0589     1.2783    0.0528</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1400.4354     1386.7669          0.0042     2.2735    0.0623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.0432          0.0128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.3508          0.9787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.0381          0.7836</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.0041          0.0358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0103          0.2643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.0144          0.1845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.0185          0.5556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.0782          0.4588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.2984          0.4634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.2428          0.5274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All            429.       185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched (ESS)   64.23     162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched        138.       162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched      291.        23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded        0.         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1:1 NN Mahalanobis distance matching within calipers</span></span></span>
<span class="r-in"><span><span class="co"># on re74 and re75 and exact matching on married and race</span></span></span>
<span class="r-in"><span><span class="va">m.out3</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span></span>
<span class="r-in"><span>                  data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>                  method <span class="op">=</span> <span class="st">"nearest"</span>,</span></span>
<span class="r-in"><span>                  distance <span class="op">=</span> <span class="st">"mahalanobis"</span>,</span></span>
<span class="r-in"><span>                  exact <span class="op">=</span> <span class="op">~</span> <span class="va">married</span> <span class="op">+</span> <span class="va">race</span>,</span></span>
<span class="r-in"><span>                  caliper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>re74 <span class="op">=</span> <span class="fl">.2</span>, re75 <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Fewer control units than treated units in some `exact` strata; not all</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> treated units will get a match.</span>
<span class="r-in"><span><span class="va">m.out3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `matchit` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: 1:1 nearest neighbor matching without replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Mahalanobis - caliper: re74 (1295.593), re75 (494.352)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 166 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, re74, re75, married, race</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out3</span>, un <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + re74 + re75, data = lalonde, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "nearest", distance = "mahalanobis", exact = ~married + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         race, caliper = c(re74 = 0.2, re75 = 0.15))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              24.7711       24.6024          0.0236     0.4804    0.0753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.3976       10.0482          0.1738     0.4610    0.0361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74            705.7326      864.0131         -0.0324     0.9038    0.0270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75            592.6384      640.9355         -0.0150     1.0194    0.0150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1687        0.1687          0.0000          .    0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.7349        0.7349          0.0000          .    0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0723        0.0723          0.0000          .    0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.1928        0.1928          0.0000          .    0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.2410          0.7544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.0964          0.7131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.2410          0.0537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.1084          0.0358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.0000          0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.0000          0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0000          0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.0000          0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All           429     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched        83      83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched     346     102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2:1 variable ratio NN matching on the PS</span></span></span>
<span class="r-in"><span><span class="va">m.out4</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                    <span class="va">married</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span></span>
<span class="r-in"><span>                  data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>                  method <span class="op">=</span> <span class="st">"nearest"</span>,</span></span>
<span class="r-in"><span>                  ratio <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                  min.controls <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                  max.controls <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m.out4</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A `matchit` object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: Variable ratio 2:1 nearest neighbor matching without replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Propensity score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - estimated with logistic regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 555 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, race, nodegree, married, re74, re75</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out4</span>, un <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + race + nodegree + married + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     re74 + re75, data = lalonde, method = "nearest", ratio = 2, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     min.controls = 1, max.controls = 12)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.5774        0.3608          0.9835     0.7425    0.1414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              25.8162       25.4459          0.0518     0.4560    0.0830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.3459       10.4887         -0.0710     0.5654    0.0236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8432        0.4703          1.0259          .    0.3730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0595        0.2110         -0.6408          .    0.1515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.0973        0.3187         -0.7472          .    0.2214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.7081        0.6517          0.1240          .    0.0564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1892        0.2218         -0.0833          .    0.0326</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           2095.5737     2614.8070         -0.1063     1.1615    0.0611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1532.0553     1714.9169         -0.0568     1.3486    0.0498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.4216          0.5600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.2457          1.4044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.0659          1.3187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.3730          0.5129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.1515          1.0629</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.2214          0.8390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.0564          1.0760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.0326          1.0420</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.2912          0.9210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.2020          0.8587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All               429     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched (ESS)     202     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched           370     185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched          59       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded           0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Some units received 1 match and some received 12</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">m.out4</span><span class="op">$</span><span class="va">subclass</span><span class="op">[</span><span class="va">m.out4</span><span class="op">$</span><span class="va">treat</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1  10  12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 168   1  16 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Ho, Kosuke Imai, Gary King, Elizabeth Stuart, Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

