<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Construct a matched dataset from a matchit object — match.data • MatchIt</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Construct a matched dataset from a matchit object — match.data" />
<meta property="og:description" content="match.data() and get_matches() create a data frame with additional variables for the distance measure, matching weights, and subclasses after matching. This dataset can be used to estimate treatment effects after matching or subclassification. get_matches() is most useful after matching with replacement; otherwise, match.data() is more flexible. See Details below for the difference between them." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MatchIt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MatchIt.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/matching-methods.html">Matching Methods</a>
    </li>
    <li>
      <a href="../articles/assessing-balance.html">Assessing Balance</a>
    </li>
    <li>
      <a href="../articles/estimating-effects.html">Estimating Effects After Matching</a>
    </li>
    <li>
      <a href="../articles/sampling-weights.html">Matching with Sampling Weights</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kosukeimai/MatchIt/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct a matched dataset from a <code>matchit</code> object</h1>
    
    <div class="hidden name"><code>match.data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>match.data()</code> and <code>get_matches()</code> create a data frame with additional variables for the distance measure, matching weights, and subclasses after matching. This dataset can be used to estimate treatment effects after matching or subclassification. <code>get_matches()</code> is most useful after matching with replacement; otherwise, <code>match.data()</code> is more flexible. See Details below for the difference between them.</p>
    </div>

    <pre class="usage"><span class='fu'>match.data</span><span class='op'>(</span><span class='va'>object</span>,
           group <span class='op'>=</span> <span class='st'>"all"</span>,
           distance <span class='op'>=</span> <span class='st'>"distance"</span>,
           weights <span class='op'>=</span> <span class='st'>"weights"</span>,
           subclass <span class='op'>=</span> <span class='st'>"subclass"</span>,
           data <span class='op'>=</span> <span class='cn'>NULL</span>,
           include.s.weights <span class='op'>=</span> <span class='cn'>TRUE</span>,
           drop.unmatched <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'>get_matches</span><span class='op'>(</span><span class='va'>object</span>,
            distance <span class='op'>=</span> <span class='st'>"distance"</span>,
            weights <span class='op'>=</span> <span class='st'>"weights"</span>,
            subclass <span class='op'>=</span> <span class='st'>"subclass"</span>,
            id <span class='op'>=</span> <span class='st'>"id"</span>,
            data <span class='op'>=</span> <span class='cn'>NULL</span>,
            include.s.weights <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>a <code>matchit</code> object; the output of a call to <code><a href='matchit.html'>matchit()</a></code>.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>which group should comprise the matched dataset: <code>"all"</code> for all units, <code>"treated"</code> for just treated units, or <code>"control"</code> for just control units. Default is <code>"all"</code>.</p></td>
    </tr>
    <tr>
      <th>distance</th>
      <td><p>a string containing the name that should be given to the variable containing the distance measure in the data frame output. Default is <code>"distance"</code>, but <code>"prop.score"</code> or similar might be a good alternative if propensity scores were used in matching. Ignored if a distance measure was not supplied or estimated in the call to <code><a href='matchit.html'>matchit()</a></code>.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>a string containing the name that should be given to the variable containing the matching weights in the data frame output. Default is <code>"weights"</code>.</p></td>
    </tr>
    <tr>
      <th>subclass</th>
      <td><p>a string containing the name that should be given to the variable containing the subclasses or matched pair membership in the data frame output. Default is <code>"subclass"</code>.</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>a string containing the name that should be given to the variable containing the unit IDs in the data frame output. Default is <code>"id"</code>. Only used with <code>get_matches()</code>; for <code>match.data()</code>, the units IDs are stored in the row names of the returned data frame.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a data frame containing the original dataset to which the computed output variables (<code>distance</code>, <code>weights</code>, and/or <code>sublcass</code>) should be appended. If empty, <code>match.data()</code> will attempt to find the dataset using the environment of the <code>matchit</code> object, which can make this unreliable if <code>match.data()</code> is used in a fresh R session or environment different from the original calling environment (e.g., inside a function) or if the original dataset changed between calling <code><a href='matchit.html'>matchit()</a></code> and <code>match.data()</code>. It is always safest to supply a data frame, which should have as many rows as and be in the same order as the data in the original call to <code><a href='matchit.html'>matchit()</a></code>. The same goes for <code>get_matches()</code>, which calls <code>match.data()</code> internally.</p></td>
    </tr>
    <tr>
      <th>include.s.weights</th>
      <td><p><code>logical</code>; whether to multiply the estimated weights by the sampling weights supplied to <code><a href='matchit.html'>matchit()</a></code>, if any. Default is <code>TRUE</code>. If <code>FALSE</code>, the weights in the <code>match.data()</code> or <code>get_matches()</code> output should be multiplied by the sampling weights before being supplied to the function estimating the treatment effect in the matched data.</p></td>
    </tr>
    <tr>
      <th>drop.unmatched</th>
      <td><p><code>logical</code>; whether the returned data frame should contain all units (<code>FALSE</code>) or only units that were matched (i.e., have a matching weight greater than zero) (<code>TRUE</code>). Default is <code>TRUE</code> to drop unmatched units.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>match.data()</code> creates a dataset with one row per unit. It will be identical to the dataset supplied except that several new columns will be added containing information related to the matching. When <code>drop.unmatched = TRUE</code>, the default, units with weights of zero, which are those units that were discarded by common support or the caliper or were simply not matched, will be dropped from the dataset, leaving only the subset of matched units. The idea is for the output of <code>match.data()</code> to be used as the dataset input in calls to <code><a href='https://rdrr.io/r/stats/glm.html'>glm()</a></code> or similar to estimate treatment effects in the matched sample. It is important to include the weights in the estimation of the effect and its standard error. The subclass column, when created, contains par or subclass membership and should be used to estimate the effect and its standard error. Subclasses will only be included if there is a <code>subclass</code> component in the <code>matchit</code> object, which does not occur with matching with replacement, in which case <code>get_matches()</code> should be used. See <code><a href='../articles/estimating-effects.html'>vignette("estimating-effects")</a></code> for information on how to use <code>match.data()</code> output to estimate effects.</p>
<p><code>get_matches()</code> is similar to <code>match.data()</code>; the primary difference occurs when matching is performed with replacement, i.e., when units do not belong to a single matched pair. In this case, the output of <code>get_matches()</code> will be a dataset that contains one row per unit for each pair they are a part of. For example, if matching was performed with replacement and a control unit was matched to two treated units, that control unit will have two rows in the output dataset, one for each pair it is a part of. Weights are computed for each row, and are equal to the inverse of the number of control units in each control unit's subclass. Unmatched units are dropped. An additional column with unit IDs will be created (named using the <code>id</code> argument) to identify when the same unit is present in multiple rows. This dataset structure allows for the inclusion of both subclass membership and repeated use of units, unlike the output of <code>match.data()</code>, which lacks subclass membership when matching is done with replacement. A <code>match.matrix</code> component of the <code>matchit</code> object must be present to use <code>get_matches()</code>; in some forms of matching, it is absent, in which case <code>match.data()</code> should be used instead. See <code><a href='../articles/estimating-effects.html'>vignette("estimating-effects")</a></code> for information on how to use <code>get_matches()</code> output to estimate effects after matching with replacement.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame containing the data supplied in the <code>data</code> argument or in the original call to <code><a href='matchit.html'>matchit()</a></code> with the computed output variables appended as additional columns, named according the arguments above. For <code>match.data()</code>, the <code>group</code> and <code>drop.unmatched</code> arguments control whether only subsets of the data are returned. See Details above for how <code>match.data()</code> and <code>get_matches()</code> differ. Note that <code>get_matches</code> sorts the data by subclass and treatment status, unlike <code>match.data()</code>, which uses the order of the data.</p>
<p>The returned data frame will contain the variables in the original data set or dataset supplied to <code>data</code>, and the following columns:</p>
<dt>distance</dt><dd><p>The propensity score, if estimated or supplied to the <code>distance</code> argument in <code><a href='matchit.html'>matchit()</a></code> as a vector.</p></dd>
<dt>weights</dt><dd><p>The computed matching weights. These must be used in effect estimation to correctly incorporate the matching.</p></dd>
<dt>subclass</dt><dd><p>Matching strata membership. Units with the same value are in the same stratum.</p></dd>
<dt>id</dt><dd><p>The ID of each unit, corresponding to the row names in the original data or dataset supplied to <code>data</code>. Only included in <code>get_matches</code> output. This column can be used to identify which rows belong to the same unit since the same unit may appear multiple times if reused in matching with replacement.</p></dd>

These columns will take on the name supplied to the corresponding arguments in the call to match.data() or get_matches(). See Examples for an example of rename the distance column to "prop.score".

If data or the original dataset supplied to matchit() was a data.table or tbl, the match.data() output will have the same class, but the get_matches() output will always be a base R data.frame.

In addition to their base class (e.g., data.frame or tbl), returned objects have the class matchdata or getmatches. This class is important when using <a href='rbind.matchdata.html'>rbind()</a> to append matched datasets.

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='matchit.html'>matchit()</a></code></p>
<p><code><a href='rbind.matchdata.html'>rbind.matchdata()</a></code></p>
<p><code><a href='../articles/estimating-effects.html'>vignette("estimating-effects")</a></code> for uses of <code>match.data()</code> and <code>get_matches()</code> in estimating treatment effects.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"lalonde"</span><span class='op'>)</span>

<span class='co'># 4:1 matching w/replacement</span>
<span class='va'>m.out1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='matchit.html'>matchit</a></span><span class='op'>(</span><span class='va'>treat</span> <span class='op'>~</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>married</span> <span class='op'>+</span>
                    <span class='va'>race</span> <span class='op'>+</span> <span class='va'>nodegree</span> <span class='op'>+</span> <span class='va'>re74</span> <span class='op'>+</span> <span class='va'>re75</span>,
                  data <span class='op'>=</span> <span class='va'>lalonde</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span>,
                  caliper <span class='op'>=</span> <span class='fl'>.05</span>, ratio <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>

<span class='va'>m.data1</span> <span class='op'>&lt;-</span> <span class='fu'>match.data</span><span class='op'>(</span><span class='va'>m.out1</span>, data <span class='op'>=</span> <span class='va'>lalonde</span>,
                      distance <span class='op'>=</span> <span class='st'>"prop.score"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>m.data1</span><span class='op'>)</span> <span class='co'>#one row per matched unit</span>
</div><div class='output co'>#&gt; [1] 347  11</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>m.data1</span>, <span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       treat age educ   race married nodegree re74 re75       re78 prop.score
#&gt; NSW1      1  37   11  black       1        1    0    0  9930.0460 0.63876993
#&gt; NSW2      1  22    9 hispan       0        1    0    0  3595.8940 0.22463424
#&gt; NSW3      1  30   12  black       0        0    0    0 24909.4500 0.67824388
#&gt; NSW4      1  27   11  black       0        1    0    0  7506.1460 0.77632408
#&gt; NSW5      1  33    8  black       0        1    0    0   289.7899 0.70163874
#&gt; NSW6      1  22    9  black       0        1    0    0  4056.4940 0.69906990
#&gt; NSW7      1  23   12  black       0        0    0    0     0.0000 0.65368426
#&gt; NSW8      1  32   11  black       0        1    0    0  8472.1580 0.78972311
#&gt; NSW9      1  22   16  black       0        0    0    0  2164.0220 0.77983825
#&gt; NSW10     1  33   12  white       1        0    0    0 12418.0700 0.04292461
#&gt;       weights
#&gt; NSW1        1
#&gt; NSW2        1
#&gt; NSW3        1
#&gt; NSW4        1
#&gt; NSW5        1
#&gt; NSW6        1
#&gt; NSW7        1
#&gt; NSW8        1
#&gt; NSW9        1
#&gt; NSW10       1</div><div class='input'>
<span class='va'>g.matches1</span> <span class='op'>&lt;-</span> <span class='fu'>get_matches</span><span class='op'>(</span><span class='va'>m.out1</span>, data <span class='op'>=</span> <span class='va'>lalonde</span>,
                          distance <span class='op'>=</span> <span class='st'>"prop.score"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>g.matches1</span><span class='op'>)</span> <span class='co'>#multiple rows per matched unit</span>
</div><div class='output co'>#&gt; [1] 820  13</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>g.matches1</span>, <span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         id subclass weights treat age educ   race married nodegree        re74
#&gt; 1     NSW1        1    1.00     1  37   11  black       1        1     0.00000
#&gt; 2   PSID69        1    0.25     0  30   17  black       0        0 17827.37000
#&gt; 3  PSID387        1    0.25     0  55    4  black       0        1     0.00000
#&gt; 4  PSID386        1    0.25     0  20   12  black       0        0     0.00000
#&gt; 5  PSID373        1    0.25     0  20   12  black       0        0     0.00000
#&gt; 6     NSW2        2    1.00     1  22    9 hispan       0        1     0.00000
#&gt; 7  PSID111        2    0.25     0  51   11  white       0        1    48.98167
#&gt; 8   PSID66        2    0.25     0  26    8 hispan       0        1  3168.13400
#&gt; 9  PSID339        2    0.25     0  26    9 hispan       0        1  1563.49500
#&gt; 10 PSID150        2    0.25     0  22   11 hispan       0        1  7341.37300
#&gt;        re75      re78 prop.score
#&gt; 1     0.000  9930.046  0.6387699
#&gt; 2  5546.419 14421.130  0.6385542
#&gt; 3     0.000     0.000  0.6357539
#&gt; 4     0.000 11594.240  0.6428929
#&gt; 5     0.000     0.000  0.6428929
#&gt; 6     0.000  3595.894  0.2246342
#&gt; 7  3813.387  1525.014  0.2240794
#&gt; 8  5872.258 11136.150  0.2225951
#&gt; 9     0.000  2862.356  0.2161957
#&gt; 10 2535.097 14187.650  0.2128728</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel Ho, Kosuke Imai, Gary King, Elizabeth Stuart, Noah Greifer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


